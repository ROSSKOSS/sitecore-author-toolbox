var initX,initY,mousePressX,debug=!1;function stripHtml(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}function sendNotification(e,t){new Notification(e,{body:t,icon:chrome.runtime.getURL("images/icon.png")}),new Audio(chrome.runtime.getURL("audio/notification.mp3")).play()}function repositionElement(e){this.style.left=initX+e.clientX-mousePressX+"px"}function startDrag(){var e=document.querySelector(".scExpTab");e&&e.addEventListener("mousedown",(function(t){initX=this.offsetLeft,mousePressX=t.clientX,this.addEventListener("mousemove",repositionElement,!1),window.addEventListener("mouseup",(function(){e.removeEventListener("mousemove",repositionElement,!1)}),!1)}),!1)}function cleanCountryName(e){var t=e;return""!=t&&t.includes(" :")&&(t=(t=t.split(" :"))[0]),(t=(t=null==(t=t.split(" ("))[1]?t[0]:t[1]).split(")"))[0].includes(", ")&&((t=t[0].split(", "))[0]=t[1],t[0]=t[0].replace(" ","_")),(t=(t=t[0].replace(" ","_")).toUpperCase()).replace("TRADITIONAL,_","").replace("SIMPLIFIED,_","").replace("U.A.E.","UNITED_ARAB_EMIRATES").replace("KOREA","SOUTH_KOREA").replace("UNITED_STATES","USA").replace("UNITED_KINGDOM","GREAT_BRITAIN").replace("ENGLISH","GREAT_BRITAIN")}function sitecoreAuthorToolbox(){var e=0,t=chrome.runtime.getURL("images/rocket.svg"),r=chrome.runtime.getURL("images/lock.svg"),n=chrome.runtime.getURL("images/error.png"),a=(chrome.runtime.getURL("images/edit.pmg"),chrome.runtime.getURL("images/translate.pmg")),o=chrome.runtime.getURL("images/Flags/32x32/flag_generic.png"),s=chrome.runtime.getURL("data/languages.json");let i=["ARABIC","HEBREW","PERSIAN","URDU","SINDHI"],c=document.querySelector(".scEditorHeader");document.querySelector(".scEditorHeaderTitle");document.getElementsByClassName("scEditorQuickInfo");let l=document.querySelector(".scEditorHeaderQuickInfoInput"),d=document.querySelector(".scEditorHeaderVersionsLanguage"),u=document.querySelector(".scEditorHeaderVersionsVersion > span");u&&(u=u.innerText);window.location.hash;let g=document.querySelector(".scEditorTabHeaderActive");document.querySelectorAll(".scRibbonEditorTabNormal");var m=document.getElementsByClassName("scValidationMarkerIcon");document.getElementsByClassName("scValidationResult");let p=document.querySelector("#EditorFrames"),f=document.querySelector(".scEditorSections"),h=(document.getElementById("SearchPanel"),document.getElementById("ContentTreeHolder")),b=!1,y=document.querySelector(".sc-accountInformation").querySelectorAll("li")[1].innerText;var v=document.getElementsByClassName("scEditorHeaderVersionsLanguage");if(v[0])var x=v[0].getAttribute("title"),L=stripHtml(v[0].innerHTML);if(l){var w=document.getElementsByClassName("scEditorHeaderQuickInfoInput"),E=w[0].getAttribute("value"),T=w[1].getAttribute("value").toLowerCase(),k=T.toLowerCase(),M=(T=T.split("/home/"))[0];M=(M=M.split("/")).slice(-1)[0].toLowerCase();var S,B=k.includes("/data/"),_=(k.includes("/marketing control panel/"),k.includes("/sitecore/templates"),k.includes("/sitecore/system"),k.includes("/sitecore/layout"),k.includes("/sitecore/forms"),k.includes("/presentation"),k.includes("/sitecore/content")),C=document.getElementById("scLanguage").getAttribute("value").toLowerCase(),A=window.location.origin+"/?sc_itemid="+E+"&sc_mode=normal&sc_lang="+C+"&sc_version="+u,I=L.includes("(");T=null!=T[1]?encodeURI(window.location.origin+"/"+C+"/"+T[1]+"?sc_site=xxxsxa_sitexxx&sc_mode=normal").toLowerCase():encodeURI(window.location.origin+"/"+C+"/?sc_site=xxxsxa_sitexxx").toLowerCase(),"home"!=M&&_&&!B?chrome.storage.sync.get(["feature_urls"],(function(e){null==e.feature_urls&&(e.feature_urls=!0),!document.getElementById("scMessageBarUrl")&&e.feature_urls&&chrome.runtime.sendMessage({greeting:"sxa_site"},(function(e){if(null!=e.farewell){var r=M.toLowerCase(),n=e.farewell.toLowerCase(),a=n.includes(r);debug&&console.log("%c - QuickInfo ("+r+") VS Cookie ("+n+") = "+a+" ","font-size:12px; background: #e3658e; color: black; border-radius:5px; padding 3px;")}T=null!=e.farewell&&a?T.replace("xxxsxa_sitexxx",e.farewell):T.replace("xxxsxa_sitexxx",M);var o='<div id="scMessageBarUrl" class="scMessageBar scWarning"><div class="scMessageBarIcon" style="background-image:url('+t+')"></div><div class="scMessageBarTextContainer"><div class="scMessageBarTitle">Sitecore Live URL</div><div class="scMessageBarText">If you want to preview this page in <b>'+x+"</b> (version "+u+')</div><ul class="scMessageBarOptions" style="margin:0px"><li class="scMessageBarOptionBullet"><a href="'+T+'" target="_blank" class="scMessageBarOption">Open this link</a> or try <a href="'+A+'" target="_blank" class="scMessageBarOption">this alternative link</a></li></ul></div></div>';c.insertAdjacentHTML("afterend",o)}))})):B&&chrome.storage.sync.get(["feature_urls"],(function(e){if(null==e.feature_urls&&(e.feature_urls=!0),!document.getElementById("scMessageBarInfo")&&e.feature_urls);}))}else if(!document.getElementById("scMessageBarUrl")&&f){var H='<div id="scMessageBarUrl" class="scMessageBar scWarning"><div class="scMessageBarIcon" style="background-image:url('+t+')"></div><div class="scMessageBarTextContainer"><div class="scMessageBarTitle">Oh snap! 😭😭😭</div><div class="scMessageBarText">To fully enjoy Sitecore Author Toolbox, please enable <b>Title bar</b> and <b>Quick info section</b> under <b>Application Options</b>.</div><ul class="scMessageBarOptions" style="margin:0px"><li class="scMessageBarOptionBullet"><a href="" onclick="javascript:return scForm.postEvent(this,event,\'shell:useroptions\')" class="scMessageBarOption">Open Application Options</a>.</li></ul></div></div>';f.insertAdjacentHTML("afterbegin",H)}chrome.storage.sync.get(["feature_flags"],(function(e){null==e.feature_flags&&(e.feature_flags=!0);var t=document.querySelector(".scEditorHeaderVersionsVersion"),r=t.getAttribute("title");if(t.querySelector("span").innerText=r.replace("."," ▾"),I)S=(S=cleanCountryName(L)).toLowerCase(),S=chrome.runtime.getURL("images/Flags/32x32/flag_"+S+".png"),!document.getElementById("scFlag")&&e.feature_flags&&S&&g.insertAdjacentHTML("afterbegin",'<img id="scFlag" src="'+S+'" style="width: 20px; vertical-align: middle; padding: 0px 5px 0px 0px;" onerror="this.onerror=null;this.src=\''+o+"';\"/>"),!document.getElementById("scFlagMenu")&&e.feature_flags&&S&&d.insertAdjacentHTML("afterbegin",'<img id="scFlagMenu" src="'+S+'" style="width: 15px; vertical-align: sub; padding: 0px 5px 0px 0px;" onerror="this.onerror=null;this.src=\''+o+"';\"/>");else if(e.feature_flags){var n=new XMLHttpRequest;n.overrideMimeType("application/json"),n.open("GET",s,!0),n.onreadystatechange=function(){if(4===n.readyState&&"200"==n.status){var t,r=JSON.parse(n.responseText);for(t in r)r.hasOwnProperty(t)&&L&&L.toUpperCase()==r[t].language.toUpperCase()&&(S=(S=r[t].flag).toLowerCase(),S=chrome.runtime.getURL("images/Flags/32x32/flag_"+S+".png"),!document.getElementById("scFlag")&&e.feature_flags&&S&&g.insertAdjacentHTML("afterbegin",'<img id="scFlag" src="'+S+'" style="width: 20px; vertical-align: middle; padding: 0px 5px 0px 0px;" onerror="this.onerror=null;this.src=\''+o+"';\"/>"),!document.getElementById("scFlagMenu")&&e.feature_flags&&S&&d.insertAdjacentHTML("afterbegin",'<img id="scFlagMenu" src="'+S+'" style="width: 15px; vertical-align: sub; padding: 0px 5px 0px 0px;" onerror="this.onerror=null;this.src=\''+o+"';\"/>"))}},n.send(null)}})),chrome.storage.sync.get(["feature_rtl"],(function(e){if(null==e.feature_rtl&&(e.feature_rtl=!0),e.feature_rtl&&L){var t;if(w=L.split(" ("),S=w[0].toUpperCase(),(link=document.createElement("link")).type="text/css",link.rel="stylesheet",i.includes(S)){link.href=chrome.runtime.getURL("css/rtl-min.css"),t=document.getElementsByClassName("scContentControlHtml");for(let e of t)e.onload=function(){e.contentWindow.document.getElementById("ContentWrapper").style.direction="RTL"}}else{link.href=chrome.runtime.getURL("css/ltr-min.css"),t=document.getElementsByClassName("scContentControlHtml");for(let e of t)e.onload=function(){e.contentWindow.document.getElementById("ContentWrapper").style.direction="LTR"}}document.getElementsByTagName("head")[0].appendChild(link)}})),chrome.storage.sync.get(["feature_errors"],(function(t){if(null==t.feature_errors&&(t.feature_errors=!0),t.feature_errors){e=0;var r='<div id="scMessageBarError" class="scMessageBar scError"><div class="scMessageBarIcon" style="background-image:url('+n+')"></div><div class="scMessageBarTextContainer"><ul class="scMessageBarOptions" style="margin:0px">';for(let t of m){var a=t.previousSibling;if(a){var o=a.closest("div").getAttribute("id").replace("ValidationMarker",""),s=(document.querySelector("#"+o).closest("table").closest("td").closest("table").previousSibling.innerText,document.querySelector("#"+o).closest("table").closest("td").closest("table").previousSibling.getAttribute("id"));document.querySelectorAll('[data-id="'+s+'"]');"/sitecore/shell/themes/standard/images/bullet_square_yellow.png"!=t.getAttribute("src")&&(r+='<li class="scMessageBarOptionBullet" onclick="'+t.getAttribute("onclick")+'" style="cursor:pointer;">'+t.getAttribute("title")+"</li>",e++)}}r+="</ul></div></div>",e>0&&c.insertAdjacentHTML("afterend",r);var i=document.querySelector(".scValidatorPanel"),l=new MutationObserver((function(t){e=0;var r='<div id="scMessageBarError" class="scMessageBar scError"><div class="scMessageBarIcon" style="background-image:url('+n+')"></div><div class="scMessageBarTextContainer"><ul class="scMessageBarOptions" style="margin:0px">';for(let t of m)"/sitecore/shell/themes/standard/images/bullet_square_yellow.png"!=t.getAttribute("src")&&(r+='<li class="scMessageBarOptionBullet" onclick="'+t.getAttribute("onclick")+'" style="cursor:pointer;">'+t.getAttribute("title")+"</li>",e++);if(r+="</ul></div></div>",e>0)c.insertAdjacentHTML("afterend",r);else{var a=document.getElementById("scMessageBarError");a&&a.parentNode.removeChild(a)}debug&&console.log("Changement: "+document.getElementsByClassName("scValidatorPanel"))}));if(i){l.observe(i,{attributes:!0,childList:!0,characterData:!0})}}}));var R=document.getElementById("EditorFrames");if(R){var q,N,U;R=R.getElementsByTagName("iframe"),e=0;for(let t of R)if(q=R[e].src,N=R[e],U=q.includes("/Media/"),e++,U){debug&&console.info("SRC of MEDIA IFRAME "+e+" - "+q);break}chrome.storage.sync.get(["feature_dragdrop"],(function(e){if(null==e.feature_dragdrop&&(e.feature_dragdrop=!0),U&&e.feature_dragdrop)N.onload=function(){var e=(q=(q=(q=q.split("id=%7B"))[1].split("%7B"))[0].split("%7D"))[0];debug&&console.info(e);var t='<iframe id="sitecorAuthorToolbox" class="sitecorAuthorToolbox" src="'+("/sitecore/client/Applications/Dialogs/UploadMediaDialog?ref=list&ro=sitecore://master/%7b"+e+"%7d%3flang%3den&fo=sitecore://master/%7b"+e+"%7d")+'" style="width:100%; height:500px; margin-top: -60px; resize: vertical;"></iframe>';N.setAttribute("style","margin-top: -30px;");var r=document.getElementById("sitecorAuthorToolbox");r&&r.remove(),p.insertAdjacentHTML("afterbegin",t)};else{var t=document.getElementById("sitecorAuthorToolbox");t&&t.remove()}}))}window.Notification?"granted"===Notification.permission||Notification.requestPermission().then((function(e){"granted"===e||console.info("User blocked notifications.")})).catch((function(e){console.warn(e)})):console.info("Browser does not support notifications."),chrome.storage.sync.get(["feature_favorites"],(function(e){if(null==e.feature_favorites&&(e.feature_favorites=!0),e.feature_favorites&&!isPublishWindow&&h){var t=document.getElementById("sitecorAuthorToolboxFav");t&&t.remove();var r='<iframe id="sitecorAuthorToolboxFav" class="sitecorAuthorToolboxFav" src="'+("../default.aspx?xmlcontrol=Gallery.Favorites&id="+E+"&la="+C+"&vs=1")+'" style="width:100%; height:150px; margin-top: 0px; resize: vertical;"></iframe>';h.insertAdjacentHTML("afterend",r)}})),chrome.storage.sync.get(["feature_charscount"],(function(e){if(null==e.feature_charscount&&(e.feature_charscount=!0),e.feature_charscount){var t,r,n=document.querySelectorAll("input, textarea"),a=0;for(var o of n)"scContentControl"!=o.className&&"scContentControlMemo"!=o.className||(o.setAttribute("style","padding-right: 70px !important"),o.parentElement.setAttribute("style","position:relative !important"),a=o.value.length,r=a>1?a+" chars":a+" char",t='<div id="chars_'+o.id+'" style="position: absolute; bottom: 1px; right: 1px; padding: 6px 10px; border-radius: 4px; line-height: 20px; opacity:0.5;">'+r+"</div>",o.insertAdjacentHTML("afterend",t));document.addEventListener("keyup",(function(e){"input"!=e.target.localName&&"textarea"!=e.target.localName||(a=e.target.value.length,r=a>1?a+" chars":a+" char",debug&&console.log("Input text: "+e.target.id+" -> "+r),document.querySelector("#chars_"+e.target.id)&&(document.querySelector("#chars_"+e.target.id).innerText=r))}),!1)}})),chrome.storage.sync.get(["feature_translatemode"],(function(t){if(null==t.feature_translatemode&&(t.feature_translatemode=!0),t.feature_translatemode){var r=document.querySelector(".scEditorPanel"),n=document.querySelectorAll(".scEditorSectionPanel .scEditorSectionPanelCell")[1],o=r.querySelectorAll("input, textarea, select");if(e=0,n&&null!=n.querySelector(".scEditorFieldMarkerInputCell > table > tbody")&&(b=!0),b){for(var s of o)if("scContentControl"==s.className||"scContentControlMemo"==s.className||"scContentControlImage"==s.className||s.className.includes("scCombobox")&&!s.className.includes("scComboboxEdit")){if(g=null,e%2==0){var i=s,l=s.getAttribute("onfocus");l=(l=(l=l.split("lang="))[1].split("&"))[0].toUpperCase()}else{var d=s,u=s.getAttribute("onfocus");u=(u=(u=u.split("lang="))[1].split("&"))[0].toUpperCase();var g=s.closest("td").parentNode.querySelectorAll("td")[1];null!=g&&(g.innerHTML='<a class="scTranslateRTL" href="javascript:copyTranslate(\''+i.id+"','"+d.id+"','RTL');\" title=\"Copy "+u+" to "+l+'"><img src="'+chrome.runtime.getURL("images/navigate_left.png")+'" style="padding: 0px 2px 0px 0px; vertical-align: bottom; width: 20px;" alt="Copy"></a>')}e++}document.getElementById("scMessageBarTranslation")||(H='<div id="scMessageBarTranslation" class="scMessageBar scInformation"><div class="scMessageBarIcon" style="background-image:url('+a+')"></div><div class="scMessageBarTextContainer"><div class="scMessageBarTitle">Translation Mode ('+u+" to "+l+')</div><div class="scMessageBarText">You are translating content. If you want, you can directly </b></div><ul class="scMessageBarOptions" style="margin:0px"><li class="scMessageBarOptionBullet"><span class="scMessageBarOption" onclick="javascript:copyTranslateAll();" style="cursor:pointer">Copy existing content into '+L+' version</span></li> or <li class="scMessageBarOptionBullet"><span class="scMessageBarOption" style="cursor:pointer !important;" onclick="window.open(\'https://translate.google.com/#view=home&op=translate&sl='+u.toLowerCase()+"&tl="+l.toLowerCase()+"&text=Hello Sitecore');\">Use Google Translate</span></li></ul></div></div>",c.insertAdjacentHTML("afterend",H))}}})),chrome.storage.sync.get(["feature_cetabs"],(function(e){if(null==e.feature_cetabs&&(e.feature_cetabs=!1),e.feature_cetabs){var t=document.querySelector("#scEditorTabs"),r=document.querySelector(".scEditorHeader"),n=document.querySelectorAll(".scMessageBar");n=n[n.length-1];var a=document.querySelectorAll(".scEditorSectionCaptionCollapsed, .scEditorSectionCaptionExpanded"),o=0;for(var s of(t&&t.remove(),t='<div id="scEditorTabs"><ul>',a)){var i=s.innerText,c=s.getAttribute("id"),l="",d="",u="";"scEditorSectionCaptionExpanded"==s.getAttribute("class")&&0==o?(l="scEditorTabSelected",d="table",o++):(l="",d="none"),s.setAttribute("style","display: none !important");var g=s.nextSibling;g.setAttribute("style","display: "+d+" !important"),g.querySelectorAll(".scEditorFieldMarkerBarCellRed").length>0&&(u="<span id='scCrossTabError'>🛑 </span>"),t+='<li class="scEditorTabEmpty"></li>',t+='<li data-id="'+c+'" class="scEditorTab '+l+'" onclick="toggleSection(this,\''+i+"');\">"+u+i+'<span class="scEditorTabClose" onclick="hideTab(\''+i+"','"+extensionId+"')\">❎</span></li>"}if(t+='<li class="scEditorTabEmpty"></li></ul></div>',n?n.insertAdjacentHTML("afterend",t):r.insertAdjacentHTML("afterend",t),0==o){var m=document.querySelector(".scEditorTab"),p=m.dataset.id,f=document.querySelector("#"+p);f.classList.remove("scEditorSectionCaptionCollapsed"),f.classList.add("scEditorSectionCaptionExpanded");var h=f.nextSibling;m.classList.add("scEditorTabSelected"),h.setAttribute("style","display: table !important")}}})),target=document.querySelector("#SearchResult"),observer=new MutationObserver((function(e){console.log(e);var t=document.querySelector("#SearchResult").querySelectorAll(".scSearchLink"),r=document.querySelector(".scSearchListExtra");for(var n of(console.log("EXTRA"),console.log(r),t)){var a=n.getAttribute("title").toLowerCase();a.includes("/home/")&&(a="/"+(a=a.split("/home/"))[1]);var o=' <span class="scSearchListExtra">'+a+"</span>";a&&null==r&&(n.innerHTML+=o)}})),target&&(config={attributes:!1,childList:!0,characterData:!1,subtree:!1},observer.observe(target,config)),setTimeout((function(){document.querySelector(".scRibbon").innerHTML.includes("Check this item in.")&&(H='<div id="scMessageBarUrl" class="scMessageBar scInformation"><div class="scMessageBarIcon" style="background-image:url('+r+')"></div><div class="scMessageBarTextContainer"><div class="scMessageBarTitle">'+y+' you have locked this item.</div><div class="scMessageBarText">Nobody is able to edit it until you unlock it.</div><ul class="scMessageBarOptions"><li class="scMessageBarOptionBullet"><a href="#" onclick="javascript:return scForm.postEvent(this,event,\'item:checkin\')" class="scMessageBarOption">Check this item in</a></li></ul></div></div>',c.insertAdjacentHTML("afterend",H))}),500),!0===debug&&(console.info("%c - Sitecore Item: "+E+" ","font-size:12px; background: #7b3090; color: white; border-radius:5px; padding 3px;"),console.info("%c - Sitecore Language: "+C+" ","font-size:12px; background: #7b3090; color: white; border-radius:5px; padding 3px;"),console.info("%c - Sitecore Version: "+u+" ","font-size:12px; background: #7b3090; color: white; border-radius:5px; padding 3px;"),console.info("%c - Translation Mode: "+b+" ","font-size:12px; background: #7b3090; color: white; border-radius:5px; padding 3px;"))}debug&&(console.info("%c *********************************** Url Loaded *********************************** ","font-size:14px; background: #32ed74; color: black; border-radius:5px; padding 3px;"),console.info("%c "+window.location.href,"font-size:8px"));var windowLocationHref=window.location.href.toLowerCase(),isSitecore=window.location.pathname.includes("/sitecore/"),isPreviewMode=document.querySelector(".pagemode-preview");isPreviewMode||(isPreviewMode=windowLocationHref.includes("sc_mode=preview"));var isEditMode=document.querySelector(".pagemode-edit");isEditMode||(isEditMode=windowLocationHref.includes("sc_mode=edit")),isEditMode||(isEditMode=windowLocationHref.includes("/experienceeditor/"));var isGalleryLanguage=windowLocationHref.includes("gallery.language"),isGalleryLanguageExpEd=windowLocationHref.includes("selectlanguagegallery"),isGalleryFavorites=windowLocationHref.includes("gallery.favorites"),isGalleryVersions=windowLocationHref.includes("gallery.versions"),isAdminCache=windowLocationHref.includes("/admin/cache.aspx"),isAdmin=windowLocationHref.includes("/admin/"),isMediaBrowser=windowLocationHref.includes("sitecore.shell.applications.media.mediabrowser"),isPublishWindow=windowLocationHref.includes("/shell/applications/publish.aspx"),isSecurityWindow=windowLocationHref.includes("/shell/applications/security/"),isExperienceEditor=windowLocationHref.includes("/applications/experienceeditor/"),isContentHome=windowLocationHref.includes("/content/"),isLoginPage=windowLocationHref.includes("sitecore/login"),isLaunchpad=windowLocationHref.includes("/client/applications/launchpad"),isDesktop=windowLocationHref.includes("/shell/default.aspx"),isRichTextEditor=windowLocationHref.includes("/controls/rich%20text%20editor/"),isHtmlEditor=windowLocationHref.includes(".edithtml.aspx"),isFieldEditor=windowLocationHref.includes("field%20editor.aspx"),isModalDialogs=windowLocationHref.includes("jquerymodaldialogs.html"),isSecurityDetails=windowLocationHref.includes("securitydetails.aspx"),isEditorFolder=windowLocationHref.includes("editors.folder.aspx"),isRibbon=windowLocationHref.includes("/ribbon.aspx"),isDialog=windowLocationHref.includes("experienceeditor/dialogs/confirm/"),isInsertPage=windowLocationHref.includes("/dialogs/insertpage/"),isCreateUser=windowLocationHref.includes("createnewuser"),isUserManager=windowLocationHref.includes("user%20manager.aspx"),isPersonalization=windowLocationHref.includes("dialogs.personalization"),isRules=windowLocationHref.includes("rules.aspx"),isCss=windowLocationHref.includes(".css"),isSearch=windowLocationHref.includes("showresult.aspx");if(isSitecore&&!isEditMode&&!isLoginPage&&!isCss){var script,link;debug&&console.info("%c ✏️ Sitecore detected ","font-size:14px; background: #f33d35; color: white; border-radius:5px; padding 3px;"),(script=document.createElement("script")).src=chrome.runtime.getURL("js/inject-min.js"),(document.head||document.documentElement).appendChild(script),script.remove(),(link=document.createElement("link")).type="text/css",link.rel="stylesheet",link.href=chrome.runtime.getURL("css/onload-min.css"),document.getElementsByTagName("head")[0].appendChild(link);var launchpadPage=chrome.runtime.getURL("options.html"),launchpadIcon=chrome.runtime.getURL("images/icon.png"),launchpadGroupTitle="Sitecore Author Toolbox",launchpadTitle="Options",launchpadUrl=windowLocationHref;if(isDesktop?(debug&&console.info("====================> DESKTOP SHELL <===================="),chrome.storage.sync.get(["feature_launchpad"],(function(e){if(null==e.feature_launchpad&&(e.feature_launchpad=!0),e.feature_launchpad){var t='<a href="#" class="scStartMenuLeftOption" title="" onclick="window.location.href=\''+launchpadPage+"?launchpad=true&url="+launchpadUrl+'\'"><img src="'+launchpadIcon+'" class="scStartMenuLeftOptionIcon" alt="" border="0"><div class="scStartMenuLeftOptionDescription"><div class="scStartMenuLeftOptionDisplayName">'+launchpadGroupTitle+'</div><div class="scStartMenuLeftOptionTooltip">'+launchpadTitle+"</div></div></a>",r=document.querySelectorAll(".scStartMenuLeftOption");for(let e of r)"Install and maintain apps."==e.getAttribute("title")&&e.insertAdjacentHTML("afterend",t)}}))):isLaunchpad?(debug&&console.info("====================> LAUNCHPAD <===================="),chrome.storage.sync.get(["feature_launchpad"],(function(e){if(null==e.feature_launchpad&&(e.feature_launchpad=!0),e.feature_launchpad){var t=document.querySelectorAll(".last"),r='<div class="sc-launchpad-group"><header class="sc-launchpad-group-title">'+launchpadGroupTitle+'</header><div class="sc-launchpad-group-row"><a href="#" onclick="window.location.href=\''+launchpadPage+"?launchpad=true&url="+launchpadUrl+'\'" class="sc-launchpad-item" title="'+launchpadTitle+'"><span class="icon"><img src="'+launchpadIcon+'" width="48" height="48" alt="'+launchpadTitle+'"></span><span class="sc-launchpad-text">'+launchpadTitle+"</span></a></div></div>";t[0].insertAdjacentHTML("afterend",r)}}))):isAdminCache&&debug&&console.info("====================> ADMIN CACHE <===================="),isSearch&&(debug&&console.info("====================> INTERNAL SEARCH <===================="),target=document.querySelector("#results"),observer=new MutationObserver((function(e){var t=document.querySelector("#results").querySelectorAll(".BlogPostArea");for(var r of t){var n=r.querySelector(".BlogPostFooter"),a=r.querySelector(".BlogPostViews > a > img").getAttribute("title");(a=(a=a.split(" - "))[1].toLowerCase()).includes("/home/")&&(a="/"+(a=a.split("/home/"))[1]);var o='<div class="BlogPostExtra BlogPostContent" style="padding: 5px 0 0px 78px; color: #4d82b8"><strong>Sitecore path:</strong> '+a+" <strong>Languages available:</strong> "+r.querySelector(".BlogPostHeader > span").getAttribute("title")+"</div>";a&&n.insertAdjacentHTML("afterend",o)}})),target&&(config={attributes:!1,childList:!0,characterData:!1,subtree:!1},observer.observe(target,config))),isFieldEditor){debug&&console.info("====================> FIELD EDITOR <===================="),chrome.storage.sync.get(["feature_charscount"],(function(e){if(null==e.feature_charscount&&(e.feature_charscount=!0),e.feature_charscount){var t,r,n=document.querySelectorAll("input, textarea"),a=0;for(var o of n)"scContentControl"!=o.className&&"scContentControlMemo"!=o.className||(o.setAttribute("style","padding-right: 70px !important"),o.parentElement.setAttribute("style","position:relative !important"),a=o.value.length,r=a>1?a+" chars":a+" char",t='<div id="chars_'+o.id+'" style="position: absolute; bottom: 1px; right: 1px; padding: 6px 10px; border-radius: 4px; line-height: 20px; opacity:0.5;">'+r+"</div>",o.insertAdjacentHTML("afterend",t));document.addEventListener("keyup",(function(e){"input"!=e.target.localName&&"textarea"!=e.target.localName||(a=e.target.value.length,r=a>1?a+" chars":a+" char",debug&&console.log("chars_"+e.target.id+" -> "+r),document.querySelector("#chars_"+e.target.id)&&(document.querySelector("#chars_"+e.target.id).innerText=r))}),!1)}}));var scBucketListSelectedBox=document.querySelectorAll(".scBucketListSelectedBox, .scContentControlMultilistBox"),Section_Data=document.querySelector("#Section_Data");(scBucketListSelectedBox=scBucketListSelectedBox[1]?scBucketListSelectedBox[1]:scBucketListSelectedBox[0])&&scBucketListSelectedBox.addEventListener("change",(function(){var e=scBucketListSelectedBox.value,t=scBucketListSelectedBox[scBucketListSelectedBox.selectedIndex].text,r=chrome.runtime.getURL("images/rocket.png"),n='<a class="scMessageBarOption" href="'+window.location.origin+"/sitecore/shell/Applications/Content%20Editor.aspx#"+e+'" target="_blank"><u>Click here ⧉</u></a> ',a='<a class="scMessageBarOption" href="'+window.location.origin+"/?sc_mode=edit&sc_itemid="+e+'" target="_blank"><u>Click here ⧉</u></a> ',o='<div id="Warnings" class="scMessageBar scWarning"><div class="scMessageBarIcon" style="background-image:url('+r+')"></div><div class="scMessageBarTextContainer"><div class="scMessageBarTitle">'+t+'</div><span id="Information" class="scMessageBarText"><span class="scMessageBarOptionBullet">'+n+'</span> to edit this item in <b>Content Editor</b>.</span><span id="Information" class="scMessageBarText"><br /><span class="scMessageBarOptionBulletXP">'+a+"</span> to edit this page in <b>Experience Editor</b>.</span></div></div>";document.querySelector(".scMessageBar")?(document.querySelector(".scMessageBarTitle").innerHTML=t,document.querySelector(".scMessageBarOptionBullet").innerHTML=n,document.querySelector(".scMessageBarOptionBulletXP").innerHTML=a):Section_Data.insertAdjacentHTML("beforebegin",o)})),chrome.storage.sync.get(["feature_errors"],(function(e){null==e.feature_errors&&(e.feature_errors=!0);var t=0,r=document.getElementsByClassName("scValidationMarkerIcon"),n=document.querySelector("#MainPanel"),a=chrome.runtime.getURL("images/error.png");if(e.feature_errors){var o='<div id="scMessageBarError" class="scMessageBar scError"><div class="scMessageBarIcon" style="background-image:url('+a+')"></div><div class="scMessageBarTextContainer"><ul class="scMessageBarOptions" style="margin:0px">';for(let e of r)"/sitecore/shell/themes/standard/images/bullet_square_yellow.png"!=e.getAttribute("src")&&(o+='<li class="scMessageBarOptionBullet" onclick="'+e.getAttribute("onclick")+'" style="cursor:pointer;">'+e.getAttribute("title")+"</li>",t++);o+="</ul></div></div>",t>0&&n.insertAdjacentHTML("beforebegin",o);var s=document.querySelector(".scValidatorPanel"),i=new MutationObserver((function(e){t=0;var o='<div id="scMessageBarError" class="scMessageBar scError"><div class="scMessageBarIcon" style="background-image:url('+a+')"></div><div class="scMessageBarTextContainer"><ul class="scMessageBarOptions" style="margin:0px">';for(let e of r)"/sitecore/shell/themes/standard/images/bullet_square_yellow.png"!=e.getAttribute("src")&&(console.log(e),o+='<li class="scMessageBarOptionBullet" onclick="'+e.getAttribute("onclick")+'" style="cursor:pointer;">'+e.getAttribute("title")+"</li>",t++);if(o+="</ul></div></div>",t>0)n.insertAdjacentHTML("beforebegin",o);else{var s=document.getElementById("scMessageBarError");s&&s.parentNode.removeChild(s)}debug&&console.log("!! Change !!")}));if(s){i.observe(s,{attributes:!0,childList:!0,characterData:!0})}}}))}(isRichTextEditor||isHtmlEditor)&&(debug&&console.info("====================> RTE / HTML EDITOR <===================="),chrome.storage.sync.get(["feature_rtecolor","feature_darkmode"],(function(e){if(null==e.feature_rtecolor&&(e.feature_rtecolor=!0),null==e.feature_darkmode&&(e.feature_darkmode=!1),e.feature_rtecolor){var t,r="default";if(isRichTextEditor?t=document.querySelector("#Editor_contentIframe"):isHtmlEditor&&(t=document.querySelector("#ctl00_ctl00_ctl05_Html")),t){if(isRichTextEditor){document.querySelector("#Editor_contentIframe").contentWindow.document.body,document.querySelector("#EditorContentHiddenTextarea");var n=document.querySelector(".reTextArea")}(link=document.createElement("link")).type="text/css",link.rel="stylesheet",link.href=chrome.runtime.getURL("css/codemirror.css"),document.getElementsByTagName("head")[0].appendChild(link),e.feature_darkmode&&(r="ayu-dark",(link=document.createElement("link")).type="text/css",link.rel="stylesheet",link.href=chrome.runtime.getURL("css/dark/ayu-dark.css"),document.getElementsByTagName("head")[0].appendChild(link)),isRichTextEditor?(n.insertAdjacentHTML("afterend",'<input type="hidden" class="scDarkMode" value="'+r+'" />'),n.insertAdjacentHTML("afterend",'<input type="hidden" class="scEditor" value="richTextEditor" />')):isHtmlEditor&&(t.insertAdjacentHTML("afterend",'<input type="hidden" class="scDarkMode" value="'+r+'" />'),t.insertAdjacentHTML("afterend",'<input type="hidden" class="scEditor" value="htmlEditor" />')),(script=document.createElement("script")).src=chrome.runtime.getURL("js/bundle.js"),(document.head||document.documentElement).appendChild(script),script.remove()}}}))),isGalleryLanguage?(debug&&console.info("====================> LANGUAGES <===================="),chrome.storage.sync.get(["feature_flags"],(function(e){if(null==e.feature_flags&&(e.feature_flags=!0),e.feature_flags){var t,r=new XMLHttpRequest;r.overrideMimeType("application/json"),r.open("GET",chrome.runtime.getURL("data/languages.json"),!0),r.onreadystatechange=function(){if(4===r.readyState&&"200"==r.status){t=JSON.parse(r.responseText);var e,n,a,o,s=document.getElementById("Languages").querySelectorAll(".scMenuPanelItem,.scMenuPanelItemSelected"),i=0;for(let r of s){i=0,e=r.getElementsByTagName("td");for(let r of e){if(0==i)a=r.getElementsByTagName("img");else{if(n=(n=r.getElementsByTagName("b"))[0].innerHTML,"0"!=r.getElementsByTagName("div")[2].innerHTML.split(" ")[0]&&r.getElementsByTagName("div")[2].setAttribute("style","background-color: yellow; display: initial; padding: 0px 3px; color: #000000 !important"),n.includes("(region)"))for(o in n=n.split(" (region"),t)t.hasOwnProperty(o)&&n[0].toUpperCase()==t[o].language.toUpperCase()&&(n=t[o].flag);else n=cleanCountryName(n);n=n.toLowerCase(),a[0].onerror=function(){this.src=chrome.runtime.getURL("images/Flags/32x32/flag_generic.png")},a[0].src=chrome.runtime.getURL("images/Flags/32x32/flag_"+n+".png")}i++}0}}},r.send(null)}}))):isPublishWindow&&(debug&&console.info("====================> PUBLISH WINDOW <===================="),chrome.storage.sync.get(["feature_flags"],(function(e){if(null==e.feature_flags&&(e.feature_flags=!0),e.feature_flags){var t,r,n,a,o,s=document.getElementById("Languages").getElementsByTagName("label"),i=new XMLHttpRequest
;i.overrideMimeType("application/json"),i.open("GET",chrome.runtime.getURL("data/languages.json"),!0),i.onreadystatechange=function(){if(4===i.readyState&&"200"==i.status){o=JSON.parse(i.responseText);for(let e of s){for(n in t=e.innerText,r=cleanCountryName(t),o)o.hasOwnProperty(n)&&r==o[n].language.toUpperCase()&&(r=o[n].flag);a=r.toLowerCase(),a=chrome.runtime.getURL("images/Flags/16x16/flag_"+a+".png"),e.insertAdjacentHTML("beforebegin",' <img id="scFlag" src="'+a+'" style="display: inline; vertical-align: middle; padding-right: 2px;" onerror="this.onerror=null;this.src=\'-/icon/Flags/16x16/flag_generic.png\';"/>')}}},i.send(null)}}))),chrome.storage.sync.get(["feature_darkmode"],(function(e){if(null==e.feature_darkmode&&(e.feature_darkmode=!1),e.feature_darkmode&&!isExperienceEditor&&!isAdminCache&&!isSecurityWindow&&!isContentHome&&!isLoginPage&&!isEditMode&&!isUserManager&&!isRules&&!isAdmin){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/default-min.css"),document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("link")).type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/ribbon-min.css"),document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("link")).type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/contentmanager-min.css"),document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("link")).type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/dialogs-min.css"),document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("link")).type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/gallery-min.css"),document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("link")).type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/speak-min.css"),document.getElementsByTagName("head")[0].appendChild(t)}})),chrome.storage.sync.get(["feature_autoexpand"],(function(e){null==e.feature_autoexpand&&(e.feature_autoexpand=!0),e.feature_autoexpand&&(document.addEventListener("click",(function(e){if(!e.target.matches(".scContentTreeNodeGlyph"))return;let t=e.target.id;setTimeout((function(){if(document&&t){let e=document.querySelector("#"+t).nextSibling.nextSibling.nextSibling;if(e){let t=e.querySelectorAll(".scContentTreeNode");1==t.length&&t[0].querySelector(".scContentTreeNodeGlyph").click()}}}),200)}),!1),document.addEventListener("mousedown",(function(e){if(!e.target.matches(".glyph"))return;let t=e.target.id,r=e.target.src.includes("collapsed");setTimeout((function(){if(document&&t&&r){var e=document.querySelector("#"+t).closest("ul").nextSibling;if(e)e.querySelector(".glyph").click()}}),200)}),!1))}));var MutationObserver=window.MutationObserver,elementObserver=new MutationObserver((function(e){debug&&console.info("%c *** Update UI *** ","font-size:14px; background: #ffce42; color: black; border-radius:5px; padding 3px;");var t=document.querySelector(".scEditorHeaderQuickInfoInput");if(t){var r=window.location.href.toLowerCase(),n=t.getAttribute("value"),a=document.getElementById("scLanguage").getAttribute("value").toLowerCase();if(document.querySelector(".scEditorHeaderVersionsVersion > span"))var o=document.querySelector(".scEditorHeaderVersionsVersion > span").innerText;var s=document.querySelectorAll(".scEditorQuickInfo"),i=(s[s.length-1],s.length),c=document.getElementsByClassName("scEditorHeaderTitle"),l=document.querySelectorAll(".scEditorHeaderQuickInfoInput"),d=l[l.length-2].getAttribute("value"),u=r.includes("&ro="),g=r.includes("&sc_ce_uri=");if(u||g||(window.location.hash=n),debug&&console.info("%c - Tabs opened: "+i+" ","font-size:12px; background: #7b3090; color: white; border-radius:5px; padding 3px;"),i>1&&!document.getElementById("showInContentTree"+i)){var m=window.location.href;m=m.split("#");var p=m[0]+"&reload#"+d;c[i-1].insertAdjacentHTML("afterend",'[<a id="showInContentTree'+i+'" href="" onclick="javascript:window.location.href=\''+p+"'; return false;\" />Show in content tree</a>]")}chrome.storage.sync.set({scItemID:n},(function(){debug&&console.info("%c [Storage Set] Item : "+n+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;")})),chrome.storage.sync.set({scLanguage:a},(function(){debug&&console.info("%c [Storage Set] Language : "+a+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;")})),chrome.storage.sync.set({scVersion:o},(function(){debug&&console.info("%c [Storage Set] Version : "+o+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;")}))}e.forEach((function(e){"attributes"==e.type&&sitecoreAuthorToolbox()}))})),element=document.getElementById("scLanguage");if(element){debug&&console.info("%c *** Reload *** ","font-size:14px; background: #ffce42; color: black; border-radius:5px; padding 3px;"),windowLocationHref=window.location.href.toLowerCase();var scLanguage=element.getAttribute("value").toLowerCase(),hash=window.location.hash.substr(1),hasRedirection=windowLocationHref.includes("&ro="),hasRedirectionOther=windowLocationHref.includes("&sc_ce_uri="),extensionId=chrome.runtime.getURL("something");extensionId=(extensionId=(extensionId=extensionId.split("chrome-extension://"))[1].split("/something"))[0],document.querySelector("body").insertAdjacentHTML("beforeend",'<input type="hidden" class="extensionId" value="'+extensionId+'" />');var snackbarVersion=1,snackbarHtml="Tab sections option is enabled. If you want to switch back to normal mode, clic Edit button.";chrome.storage.sync.get(["hideSnackbar","feature_cetabs"],(function(e){if(!chrome.runtime.error&&e.hideSnackbar!=snackbarVersion&&0!=e.feature_cetabs){var t='<div class="snackbar"> '+snackbarHtml+" <button onclick=\"window.open(' "+launchpadPage+"?launchpad=true&url= "+windowLocationHref+' &tabs=0 \');">EDIT</button><button id="sbDismiss">DISMISS</button></div>';document.querySelector("body").insertAdjacentHTML("beforeend",t),document.querySelector("#sbDismiss").addEventListener("click",(function(){chrome.runtime.sendMessage({greeting:"hide_snackbar",version:snackbarVersion},(function(e){null!=e.farewell&&(console.log(e),document.querySelector(".snackbar").setAttribute("style","display: none"))}))}))}})),hasRedirection||hasRedirectionOther||chrome.storage.sync.get(["scItemID","scLanguage","scVersion","feature_reloadnode"],(function(e){if(!chrome.runtime.error&&null!=e.scItemID&&(null==e.feature_reloadnode&&(e.feature_reloadnode=!0),""!=hash&&(e.scItemID!=hash&&(e.scVersion=1),e.scItemID=hash,debug&&console.info("%c - Sitecore Hash : "+hash+" ","font-size:12px; background: #7b3090; color: white; border-radius:5px; padding 3px;")),e.scItemID&&1==e.feature_reloadnode)){var t='scForm.invoke("item:load(id='+e.scItemID+",language="+e.scLanguage+",version="+e.scVersion+')");';(script=document.createElement("script")).textContent=t,(document.head||document.documentElement).appendChild(script),script.remove(),debug&&console.info("%c [Storage Get] Item : "+e.scItemID+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;"),debug&&console.info("%c [Storage Get] Language : "+e.scLanguage+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;"),debug&&console.info("%c [Storage Get] Version : "+e.scVersion+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;")}})),sitecoreAuthorToolbox(),elementObserver.observe(element,{attributes:!0})}var elementObserver2=new MutationObserver((function(e){chrome.storage.sync.get(["feature_notification"],(function(e){if(null==e.feature_notification&&(e.feature_notification=!0),e.feature_notification){element2.getElementsByClassName("DialogHeader").item(0).innerHTML;sendNotification(element2.getElementsByClassName("sc-text-largevalue").item(0).innerHTML,element2.getElementsByClassName("scFieldLabel").item(0).innerHTML)}})),debug&&console.info("%c *** Publish Done *** ","font-size:14px; background: #ffce42; color: black; border-radius:5px; padding 3px;")})),element2=document.getElementById("LastPage");element2&&(debug&&console.info("%c *** Open Dialog *** ","font-size:14px; background: #ffce42; color: black; border-radius:5px; padding 3px;"),elementObserver2.observe(element2,{attributes:!0}))}if(isEditMode&&!isLoginPage||isPreviewMode&&!isLoginPage){if(debug&&console.info("%c 🎨 Experience Editor detected ","font-size:14px; background: #f16100; color: black; border-radius:5px; padding 3px;"),(link=document.createElement("link")).type="text/css",link.rel="stylesheet",link.href=chrome.runtime.getURL("css/onload-min.css"),document.getElementsByTagName("head")[0].appendChild(link),(link=document.createElement("link")).type="text/css",link.rel="stylesheet",link.href=chrome.runtime.getURL("css/reset-min.css"),document.getElementsByTagName("head")[0].appendChild(link),(link=document.createElement("link")).type="text/css",link.rel="stylesheet",link.href=chrome.runtime.getURL("css/tooltip-min.css"),document.getElementsByTagName("head")[0].appendChild(link),(script=document.createElement("script")).src=chrome.runtime.getURL("js/inject-min.js"),(document.head||document.documentElement).appendChild(script),script.remove(),isGalleryLanguageExpEd&&(debug&&console.info("====================> LANGUAGES IN EXPERIENCE EDITOR <===================="),chrome.storage.sync.get(["feature_flags"],(function(e){if(null==e.feature_flags&&(e.feature_flags=!0),e.feature_flags){var t,r=new XMLHttpRequest;r.overrideMimeType("application/json"),r.open("GET",chrome.runtime.getURL("data/languages.json"),!0),r.onreadystatechange=function(){if(4===r.readyState&&"200"==r.status){t=JSON.parse(r.responseText);var e,n,a,o,s=document.querySelector(".sc-gallery-content").querySelectorAll(".sc-gallery-option-content,.sc-gallery-option-content-active");for(let r of s){for(o in e=r.closest(".sc-gallery-option-content,.sc-gallery-option-content-active"),n=r.querySelector(".sc-gallery-option-content-header > span").innerText,"0"!=(a=r.querySelector(".sc-gallery-option-content-description > span")).innerHTML.split(" ")[0]&&a.setAttribute("style","background-color: yellow; display: initial; padding: 0px 3px; color: #000000 !important"),n=cleanCountryName(n),t)t.hasOwnProperty(o)&&n==t[o].language.toUpperCase()&&(n=t[o].flag);e.setAttribute("style","padding-left:48px; background-image: url("+chrome.runtime.getURL("images/Flags/32x32/flag_"+n+".png")+"); background-repeat: no-repeat; background-position: 5px;")}}},r.send(null)}}))),isRibbon){debug&&console.info("====================> RIBBON <====================");var tdlanguage,temp,key,jsonData,scRibbonFlagIcons=document.querySelectorAll(".flag_generic_24"),rawFile=new XMLHttpRequest;rawFile.overrideMimeType("application/json"),rawFile.open("GET",chrome.runtime.getURL("data/languages.json"),!0),rawFile.onreadystatechange=function(){if(4===rawFile.readyState&&"200"==rawFile.status)for(var e of(jsonData=JSON.parse(rawFile.responseText),scRibbonFlagIcons)){for(key in tdlanguage=cleanCountryName(tdlanguage=e.nextSibling.innerText),jsonData)jsonData.hasOwnProperty(key)&&tdlanguage==jsonData[key].language.toUpperCase()&&(tdlanguage=jsonData[key].flag);e.setAttribute("style","background-image: url("+chrome.runtime.getURL("images/Flags/24x24/flag_"+tdlanguage+".png")+"); background-repeat: no-repeat; background-position: top left;")}},rawFile.send(null);var dataItemId=document.querySelector("[data-sc-itemid]");if(dataItemId){var sitecoreItemID=decodeURI(dataItemId.getAttribute("data-sc-itemid"));chrome.storage.sync.set({scItemID:sitecoreItemID},(function(){debug&&console.info("%c [Storage Set] Item : "+sitecoreItemID+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;")}))}}var observer=new MutationObserver((function(e){var t=document.querySelectorAll(".scChromeToolbar");for(var r of t){r.setAttribute("style","margin-left:50px");var n=r.querySelectorAll(".scChromeCommand");r.querySelector(".scChromeText"),r.querySelector(".scChromeCommandText");for(var a of n){var o=a.getAttribute("title");a.setAttribute("style","z-index:auto"),null!=o&&(a.setAttribute("data-tooltip",o),a.classList.add("t-bottom"),a.classList.add("t-sm"),a.removeAttribute("title"))}}})),target=document.querySelector(".scChromeControls");if(target){var config={attributes:!0,childList:!0,characterData:!0};observer.observe(target,config)}chrome.storage.sync.get(["feature_darkmode","feature_toggleribbon"],(function(e){var t=document.querySelector(".pagemode-edit");t||(t=document.querySelector(".on-page-editor")),t||(t=document.querySelector(".experience-editor"));var r=(windowLocationHref=window.location.href.toLowerCase()).includes("?"),n=windowLocationHref.includes("sc_mode=edit"),a=windowLocationHref.includes("sc_mode=preview");document.querySelector("#scCrossPiece"),document.querySelector("#scWebEditRibbon"),document.querySelector(".sc-messageBar");let o;if(null==e.feature_darkmode&&(e.feature_darkmode=!1),null==e.feature_toggleribbon&&(e.feature_toggleribbon=!0),e.feature_darkmode&&isRibbon||e.feature_darkmode&&isDialog||e.feature_darkmode&&isInsertPage){var s=document.createElement("link");s.type="text/css",s.rel="stylesheet",s.href=chrome.runtime.getURL("css/dark/experience-min.css"),document.getElementsByTagName("head")[0].appendChild(s)}e.feature_darkmode&&(o="dark");var i=new MutationObserver((function(e){for(var t of e)for(var r of t.addedNodes)if("scCrossPiece"==r.id){var n='<div class="scExpTab '+o+'"><span class="tabHandle"></span><span class="tabText" onclick="toggleRibbon()">▲ Hide<span></div>';r.insertAdjacentHTML("afterend",n),i.disconnect(),startDrag()}})),c=document.body;if(e.feature_toggleribbon&&c){i.observe(c,{attributes:!1,childList:!0,characterData:!1})}var l=chrome.runtime.getURL("images/sat.png");if(n?windowLocationHref=windowLocationHref.replace("sc_mode=edit","sc_mode=normal"):a?windowLocationHref=windowLocationHref.replace("sc_mode=preview","sc_mode=normal"):windowLocationHref+=r?"&sc_mode=normal":"?sc_mode=normal",e.feature_toggleribbon&&!isRibbon){var d='<div class="scNormalModeTab '+o+'"><span class="t-right t-sm" data-tooltip="Open in Normal Mode"><a href="'+windowLocationHref+'"><img src="'+l+'"/></a></span></div>';t.insertAdjacentHTML("afterend",d)}var u=chrome.runtime.getURL("images/ce.png");e.feature_toggleribbon&&!isRibbon&&(d='<div class="scContentEditorTab '+o+'"><span class="t-right t-sm" data-tooltip="Open in Content Editor"><a href="'+window.location.origin+'/sitecore/shell/Applications/Content%20Editor.aspx?sc_bw=1"><img src="'+u+'"/></a></span></div>',t.insertAdjacentHTML("afterend",d))}))}