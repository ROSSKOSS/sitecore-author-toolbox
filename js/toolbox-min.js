var debug=!1;function stripHtml(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}function sendNotification(e,t){new Notification(e,{body:t,icon:chrome.runtime.getURL("images/icon.png")})}function sitecoreAuthorToolbox(){var e=0,t=chrome.runtime.getURL("images/rocket.png"),a=chrome.runtime.getURL("images/error.png"),r=chrome.runtime.getURL("images/edit.png"),s=chrome.runtime.getURL("images/Flags/32x32/flag_generic.png"),n=chrome.runtime.getURL("data/languages.json");let o=["ARABIC","HEBREW","PERSIAN","URDU","SINDHI"],i=document.querySelector(".scEditorHeader");document.querySelector(".scEditorHeaderTitle");document.getElementsByClassName("scEditorQuickInfo");let c=document.querySelector(".scEditorHeaderQuickInfoInput"),l=document.querySelector(".scEditorHeaderVersionsLanguage"),d=document.querySelector(".scEditorHeaderVersionsVersion > span").innerText,u=(window.location.hash,document.querySelector(".scEditorTabHeaderActive"));document.querySelectorAll(".scRibbonEditorTabNormal");var g=document.getElementsByClassName("scValidationMarkerIcon");document.getElementsByClassName("scValidationResult");let p=document.querySelector("#EditorFrames"),m=document.querySelector(".scEditorSections"),f=(document.getElementById("SearchPanel"),document.getElementById("ContentTreeHolder"));var h=document.getElementsByClassName("scEditorHeaderVersionsLanguage");if(h[0])var b=h[0].getAttribute("title"),x=stripHtml(h[0].innerHTML);if(c){var y=document.getElementsByClassName("scEditorHeaderQuickInfoInput"),v=y[0].getAttribute("value"),E=y[1].getAttribute("value").toLowerCase(),T=E.toLowerCase(),B=(E=E.split("/home/"))[0];B=(B=B.split("/")).slice(-1)[0].toLowerCase();var M,_=T.includes("/data/"),A=document.getElementById("scLanguage").getAttribute("value").toLowerCase(),L=window.location.origin+"/?sc_itemid="+v+"&sc_mode=normal&sc_lang="+A+"&sc_version="+d,I=x.includes("(");E=null!=E[1]?encodeURI(window.location.origin+"/"+A+"/"+E[1]+"?sc_site=xxxsxa_sitexxx&sc_mode=normal").toLowerCase():encodeURI(window.location.origin+"/"+A+"/?sc_site=xxxsxa_sitexxx").toLowerCase(),"home"==B||_?_&&chrome.storage.sync.get(["feature_urls"],(function(e){if(null==e.feature_urls&&(e.feature_urls=!0),!document.getElementById("scMessageBarInfo")&&e.feature_urls){var t='<div id="scMessageBarInfo" class="scMessageBar scInformation"><div class="scMessageBarIcon" style="background-image:url('+r+')"></div><div class="scMessageBarTextContainer"><div class="scMessageBarTitle">You are editing a data source...</div><div class="scMessageBarText">To see it, you need to add/edit it to your page via the</b></div><ul class="scMessageBarOptions" style="margin:0px"><li class="scMessageBarOptionBullet"><span class="scMessageBarOption">Presentation Details</span> or <span class="scMessageBarOption">Experience Editor</span></li></ul></div></div>';i.insertAdjacentHTML("afterend",t)}})):chrome.storage.sync.get(["feature_urls"],(function(e){null==e.feature_urls&&(e.feature_urls=!0),!document.getElementById("scMessageBarUrl")&&e.feature_urls&&chrome.runtime.sendMessage({greeting:"sxa_site"},(function(e){if(null!=e.farewell){var a=B.toLowerCase(),r=e.farewell.toLowerCase(),s=r.includes(a);debug&&console.log("%c - QuickInfo ("+a+") VS Cookie ("+r+") = "+s+" ","font-size:12px; background: #e3658e; color: black; border-radius:5px; padding 3px;")}E=null!=e.farewell&&s?E.replace("xxxsxa_sitexxx",e.farewell):E.replace("xxxsxa_sitexxx",B);var n='<div id="scMessageBarUrl" class="scMessageBar scWarning"><div class="scMessageBarIcon" style="background-image:url('+t+')"></div><div class="scMessageBarTextContainer"><div class="scMessageBarTitle">Sitecore Live URL</div><div class="scMessageBarText">If you want to preview this page in <b>'+b+"</b> (version "+d+')</div><ul class="scMessageBarOptions" style="margin:0px"><li class="scMessageBarOptionBullet"><a href="'+E+'" target="_blank" class="scMessageBarOption">Open this link</a> or try <a href="'+L+'" target="_blank" class="scMessageBarOption">this alternative link</a></li></ul></div></div>';i.insertAdjacentHTML("afterend",n)}))}))}else if(!document.getElementById("scMessageBarUrl")&&m){var w='<div id="scMessageBarUrl" class="scMessageBar scWarning"><div class="scMessageBarIcon" style="background-image:url('+t+')"></div><div class="scMessageBarTextContainer"><div class="scMessageBarTitle">Oh snap! 😭😭😭</div><div class="scMessageBarText">To fully enjoy Sitecore Author Toolbox, please enable <b>Title bar</b> and <b>Quick info section</b> under <b>Application Options</b>.</div><ul class="scMessageBarOptions" style="margin:0px"><li class="scMessageBarOptionBullet"><a href="" onclick="javascript:return scForm.postEvent(this,event,\'shell:useroptions\')" class="scMessageBarOption">Open Application Options</a>.</li></ul></div></div>';m.insertAdjacentHTML("afterbegin",w)}chrome.storage.sync.get(["feature_flags"],(function(e){if(null==e.feature_flags&&(e.feature_flags=!0),I)(y=(y=(y=null==(y=x.split(" ("))[1]?y[0]:y[1]).split(")"))[0].split(" :"))[0].includes(", ")&&((y=y[0].split(", "))[0]=y[1],y[0]=y[0].replace(" ","_")),y=(y=y[0].replace(" ","_")).toUpperCase(),M=(M=(M=(M=(M=(M=(M=(M=y.replace("TRADITIONAL,_","")).replace("SIMPLIFIED,_","")).replace("U.A.E.","UNITED_ARAB_EMIRATES")).replace("KOREA","SOUTH_KOREA")).replace("UNITED_STATES","USA")).replace("UNITED_KINGDOM","GREAT_BRITAIN")).replace("ENGLISH","GREAT_BRITAIN")).toLowerCase(),M=chrome.runtime.getURL("images/Flags/32x32/flag_"+M+".png"),!document.getElementById("scFlag")&&e.feature_flags&&M&&u.insertAdjacentHTML("afterbegin",'<img id="scFlag" src="'+M+'" style="width: 20px; vertical-align: middle; padding: 0px 5px 0px 0px;" onerror="this.onerror=null;this.src=\''+s+"';\"/>"),!document.getElementById("scFlagMenu")&&e.feature_flags&&M&&l.insertAdjacentHTML("afterbegin",'<img id="scFlagMenu" src="'+M+'" style="width: 15px; vertical-align: sub; padding: 0px 5px 0px 0px;" onerror="this.onerror=null;this.src=\''+s+"';\"/>");else if(e.feature_flags){var t=new XMLHttpRequest;t.overrideMimeType("application/json"),t.open("GET",n,!0),t.onreadystatechange=function(){if(4===t.readyState&&"200"==t.status){var a,r=JSON.parse(t.responseText);for(a in r)r.hasOwnProperty(a)&&x.toUpperCase()==r[a].language.toUpperCase()&&(M=(M=r[a].flag).toLowerCase(),M=chrome.runtime.getURL("images/Flags/32x32/flag_"+M+".png"),!document.getElementById("scFlag")&&e.feature_flags&&M&&u.insertAdjacentHTML("afterbegin",'<img id="scFlag" src="'+M+'" style="width: 20px; vertical-align: middle; padding: 0px 5px 0px 0px;" onerror="this.onerror=null;this.src=\''+s+"';\"/>"),!document.getElementById("scFlagMenu")&&e.feature_flags&&M&&l.insertAdjacentHTML("afterbegin",'<img id="scFlagMenu" src="'+M+'" style="width: 15px; vertical-align: sub; padding: 0px 5px 0px 0px;" onerror="this.onerror=null;this.src=\''+s+"';\"/>"))}},t.send(null)}})),chrome.storage.sync.get(["feature_rtl"],(function(e){if(null==e.feature_rtl&&(e.feature_rtl=!0),e.feature_rtl&&x){var t;if(y=x.split(" ("),M=y[0].toUpperCase(),(link=document.createElement("link")).type="text/css",link.rel="stylesheet",o.includes(M)){link.href=chrome.runtime.getURL("css/rtl-min.css"),t=document.getElementsByClassName("scContentControlHtml");for(let e of t)e.onload=function(){e.contentWindow.document.getElementById("ContentWrapper").style.direction="RTL"}}else{link.href=chrome.runtime.getURL("css/ltr-min.css"),t=document.getElementsByClassName("scContentControlHtml");for(let e of t)e.onload=function(){e.contentWindow.document.getElementById("ContentWrapper").style.direction="LTR"}}document.getElementsByTagName("head")[0].appendChild(link)}})),chrome.storage.sync.get(["feature_errors"],(function(t){if(null==t.feature_errors&&(t.feature_errors=!0),t.feature_errors){e=0;var r='<div id="scMessageBarError" class="scMessageBar scError"><div class="scMessageBarIcon" style="background-image:url('+a+')"></div><div class="scMessageBarTextContainer"><ul class="scMessageBarOptions" style="margin:0px">';for(let t of g)"/sitecore/shell/themes/standard/images/bullet_square_yellow.png"!=t.getAttribute("src")&&(r+='<li class="scMessageBarOptionBullet" onclick="'+t.getAttribute("onclick")+'" style="cursor:pointer;">'+t.getAttribute("title")+"</li>",e++);r+="</ul></div></div>",e>0&&i.insertAdjacentHTML("afterend",r);var s=document.querySelector(".scValidatorPanel"),n=new MutationObserver((function(t){e=0;var r='<div id="scMessageBarError" class="scMessageBar scError"><div class="scMessageBarIcon" style="background-image:url('+a+')"></div><div class="scMessageBarTextContainer"><ul class="scMessageBarOptions" style="margin:0px">';for(let t of g)"/sitecore/shell/themes/standard/images/bullet_square_yellow.png"!=t.getAttribute("src")&&(r+='<li class="scMessageBarOptionBullet" onclick="'+t.getAttribute("onclick")+'" style="cursor:pointer;">'+t.getAttribute("title")+"</li>",e++);if(r+="</ul></div></div>",e>0)i.insertAdjacentHTML("afterend",r);else{var s=document.getElementById("scMessageBarError");s&&s.parentNode.removeChild(s)}debug&&console.log("Changement: "+document.getElementsByClassName("scValidatorPanel"))}));if(s){n.observe(s,{attributes:!0,childList:!0,characterData:!0})}}}));var S=document.getElementById("EditorFrames");if(S){var k,C,R;S=S.getElementsByTagName("iframe"),e=0;for(let t of S)if(k=S[e].src,C=S[e],R=k.includes("/Media/"),e++,R){debug&&console.info("SRC of MEDIA IFRAME "+e+" - "+k);break}chrome.storage.sync.get(["feature_dragdrop"],(function(e){if(null==e.feature_dragdrop&&(e.feature_dragdrop=!0),R&&e.feature_dragdrop)C.onload=function(){var e='<iframe id="sitecorAuthorToolbox" class="sitecorAuthorToolbox" src="'+("/sitecore/client/Applications/Dialogs/UploadMediaDialog?fo=sitecore://master/{"+(k=(k=k.split("id=%7B"))[1].split("%7B"))[0]+"}")+'" style="width:100%; height:500px; margin-top: -60px; resize: vertical;"></iframe>';C.setAttribute("style","margin-top: -30px;");var t=document.getElementById("sitecorAuthorToolbox");t&&(t.remove(),debug&&console.info("Remove iFrame from DOM")),p.insertAdjacentHTML("afterbegin",e)};else{var t=document.getElementById("sitecorAuthorToolbox");t&&(t.remove(),debug&&console.info("Remove iFrame from DOM (no folder)"))}}))}window.Notification?"granted"===Notification.permission||Notification.requestPermission().then((function(e){"granted"===e||console.info("User blocked notifications.")})).catch((function(e){console.warn(e)})):console.info("Browser does not support notifications."),chrome.storage.sync.get(["feature_favorites"],(function(e){if(null==e.feature_favorites&&(e.feature_favorites=!0),e.feature_favorites&&!isPublishWindow&&f){var t=document.getElementById("sitecorAuthorToolboxFav");t&&t.remove();var a='<iframe id="sitecorAuthorToolboxFav" class="sitecorAuthorToolboxFav" src="'+("../default.aspx?xmlcontrol=Gallery.Favorites&id="+v+"&la="+A+"&vs=1")+'" style="width:100%; height:150px; margin-top: 0px; resize: vertical;"></iframe>';f.insertAdjacentHTML("afterend",a)}})),chrome.storage.sync.get(["feature_charscount"],(function(e){if(null==e.feature_charscount&&(e.feature_charscount=!0),e.feature_charscount){var t,a,r=document.querySelectorAll("input, textarea"),s=0;for(var n of r)"scContentControl"!=n.className&&"scContentControlMemo"!=n.className||(n.setAttribute("style","padding-right: 70px !important"),n.parentElement.setAttribute("style","position:relative !important"),s=n.value.length,a=s>1?s+" chars":s+" char",t='<div id="chars_'+n.id+'" style="position: absolute; bottom: 1px; right: 1px; padding: 6px 10px; border-radius: 4px; line-height: 20px; opacity:0.5;">'+a+"</div>",n.insertAdjacentHTML("afterend",t));document.addEventListener("keyup",(function(e){"input"!=e.target.localName&&"textarea"!=e.target.localName||(s=e.target.value.length,a=s>1?s+" chars":s+" char",debug&&console.log("chars_"+e.target.id+" -> "+a),document.querySelector("#chars_"+e.target.id)&&(document.querySelector("#chars_"+e.target.id).innerText=a))}),!1)}})),!0===debug&&(console.info("%c - Sitecore Item: "+v+" ","font-size:12px; background: #7b3090; color: white; border-radius:5px; padding 3px;"),console.info("%c - Sitecore Language: "+A+" ","font-size:12px; background: #7b3090; color: white; border-radius:5px; padding 3px;"),console.info("%c - Sitecore Version: "+d+" ","font-size:12px; background: #7b3090; color: white; border-radius:5px; padding 3px;"))}var script=document.createElement("script");script.src=chrome.runtime.getURL("js/BucketList-min.js"),(document.head||document.documentElement).appendChild(script),script.remove();var link=document.createElement("link");link.type="text/css",link.rel="stylesheet",link.href=chrome.runtime.getURL("css/onload-min.css"),document.getElementsByTagName("head")[0].appendChild(link),debug&&(console.info("%c *********************************** Url Loaded *********************************** ","font-size:14px; background: #32ed74; color: black; border-radius:5px; padding 3px;"),console.info("%c "+window.location.href,"font-size:8px"));var isSitecore=window.location.pathname.includes("/sitecore/"),isEditMode=document.querySelector(".pagemode-edit");isEditMode||(isEditMode=window.location.href.includes("sc_mode=edit")),isEditMode||(isEditMode=window.location.href.includes("/ExperienceEditor/"));var isGalleryLanguage=window.location.href.includes("Gallery.Language"),isGalleryLanguageExpEd=window.location.href.includes("SelectLanguageGallery"),isGalleryFavorites=window.location.href.includes("Gallery.Favorites"),isGalleryVersions=window.location.href.includes("Gallery.Versions"),isAdminCache=window.location.href.includes("/admin/cache.aspx"),isMediaBrowser=window.location.href.includes("Sitecore.Shell.Applications.Media.MediaBrowser"),isPublishWindow=window.location.href.includes("/shell/Applications/Publish.aspx"),isSecurityWindow=window.location.href.includes("/shell/Applications/Security/"),isExperienceEditor=window.location.href.includes("/Applications/ExperienceEditor/"),isContentHome=window.location.href.includes("/content/"),isLoginPage=window.location.href.includes("sitecore/login"),isLaunchpad=window.location.href.includes("/client/Applications/Launchpad"),isDesktop=window.location.href.includes("/shell/default.aspx"),isRichTextEditor=window.location.href.includes("/Controls/Rich%20Text%20Editor/"),isFieldEditor=window.location.href.includes("field%20editor.aspx"),isModalDialogs=window.location.href.includes("JqueryModalDialogs.html"),isSecurityDetails=window.location.href.includes("SecurityDetails.aspx"),isEditorFolder=window.location.href.includes("Editors.Folder.aspx"),isRibbon=window.location.href.includes("/Ribbon.aspx"),isInsertPage=window.location.href.includes("/Dialogs/InsertPage/"),launchpadPage=chrome.runtime.getURL("options.html"),launchpadIcon=chrome.runtime.getURL("images/icon.png"),launchpadGroupTitle="Sitecore Author Toolbox",launchpadTitle="Options",launchpadUrl=window.location.href;if(isSitecore&&!isEditMode&&!isLoginPage){if(debug&&console.info("%c ✏️ Sitecore detected ","font-size:14px; background: #f33d35; color: white; border-radius:5px; padding 3px;"),isDesktop?(debug&&console.info("====================> SHELL <===================="),chrome.storage.sync.get(["feature_launchpad"],(function(e){if(null==e.feature_launchpad&&(e.feature_launchpad=!0),e.feature_launchpad){var t='<a href="#" class="scStartMenuLeftOption" title="" onclick="window.location.href=\''+launchpadPage+"?launchpad=true&url="+launchpadUrl+'\'"><img src="'+launchpadIcon+'" class="scStartMenuLeftOptionIcon" alt="" border="0"><div class="scStartMenuLeftOptionDescription"><div class="scStartMenuLeftOptionDisplayName">'+launchpadGroupTitle+'</div><div class="scStartMenuLeftOptionTooltip">'+launchpadTitle+"</div></div></a>",a=document.querySelectorAll(".scStartMenuLeftOption");for(let e of a)"Install and maintain apps."==e.getAttribute("title")&&e.insertAdjacentHTML("afterend",t)}}))):isLaunchpad?(debug&&console.info("====================> LAUNCHPAD <===================="),chrome.storage.sync.get(["feature_launchpad"],(function(e){if(null==e.feature_launchpad&&(e.feature_launchpad=!0),e.feature_launchpad){var t=document.querySelectorAll(".last"),a='<div class="sc-launchpad-group"><header class="sc-launchpad-group-title">'+launchpadGroupTitle+'</header><div class="sc-launchpad-group-row"><a href="#" onclick="window.location.href=\''+launchpadPage+"?launchpad=true&url="+launchpadUrl+'\'" class="sc-launchpad-item" title="'+launchpadTitle+'"><span class="icon"><img src="'+launchpadIcon+'" width="48" height="48" alt="'+launchpadTitle+'"></span><span class="sc-launchpad-text">'+launchpadTitle+"</span></a></div></div>";t[0].insertAdjacentHTML("afterend",a)}}))):isAdminCache&&debug&&console.info("====================> ADMIN CACHE <===================="),isFieldEditor){debug&&console.info("====================> FIELD EDITOR <===================="),chrome.storage.sync.get(["feature_charscount"],(function(e){if(null==e.feature_charscount&&(e.feature_charscount=!0),e.feature_charscount){var t,a,r=document.querySelectorAll("input, textarea"),s=0;for(var n of r)"scContentControl"!=n.className&&"scContentControlMemo"!=n.className||(n.setAttribute("style","padding-right: 70px !important"),n.parentElement.setAttribute("style","position:relative !important"),s=n.value.length,a=s>1?s+" chars":s+" char",t='<div id="chars_'+n.id+'" style="position: absolute; bottom: 1px; right: 1px; padding: 6px 10px; border-radius: 4px; line-height: 20px; opacity:0.5;">'+a+"</div>",n.insertAdjacentHTML("afterend",t));document.addEventListener("keyup",(function(e){"input"!=e.target.localName&&"textarea"!=e.target.localName||(s=e.target.value.length,a=s>1?s+" chars":s+" char",debug&&console.log("chars_"+e.target.id+" -> "+a),document.querySelector("#chars_"+e.target.id)&&(document.querySelector("#chars_"+e.target.id).innerText=a))}),!1)}}));var scBucketListSelectedBox=document.querySelectorAll(".scBucketListSelectedBox, .scContentControlMultilistBox"),Section_Data=document.querySelector("#Section_Data");(scBucketListSelectedBox=scBucketListSelectedBox[1]?scBucketListSelectedBox[1]:scBucketListSelectedBox[0])&&scBucketListSelectedBox.addEventListener("change",(function(){var e=scBucketListSelectedBox.value,t=scBucketListSelectedBox[scBucketListSelectedBox.selectedIndex].text,a=chrome.runtime.getURL("images/rocket.png"),r='<a class="scMessageBarOption" href="'+window.location.origin+"/sitecore/shell/Applications/Content%20Editor.aspx#"+e+'" target="_blank">Open it in a new tab.</a> ',s='<div id="Warnings" class="scMessageBar scWarning"><div class="scMessageBarIcon" style="background-image:url('+a+')"></div><div class="scMessageBarTextContainer"><div class="scMessageBarTitle">'+t+'</div><span id="Information" class="scMessageBarText">To edit this item in Content Editor</span><ul class="scMessageBarOptions" style="margin:0px"><li class="scMessageBarOptionBullet">'+r+"</li></ul></div></div>";document.querySelector(".scMessageBar")?(document.querySelector(".scMessageBarTitle").innerHTML=t,document.querySelector(".scMessageBarOptionBullet").innerHTML=r):Section_Data.insertAdjacentHTML("beforebegin",s)})),chrome.storage.sync.get(["feature_errors"],(function(e){null==e.feature_errors&&(e.feature_errors=!0);var t=0,a=document.getElementsByClassName("scValidationMarkerIcon"),r=document.querySelector("#MainPanel"),s=chrome.runtime.getURL("images/error.png");if(e.feature_errors){var n='<div id="scMessageBarError" class="scMessageBar scError"><div class="scMessageBarIcon" style="background-image:url('+s+')"></div><div class="scMessageBarTextContainer"><ul class="scMessageBarOptions" style="margin:0px">';for(let e of a)"/sitecore/shell/themes/standard/images/bullet_square_yellow.png"!=e.getAttribute("src")&&(n+='<li class="scMessageBarOptionBullet" onclick="'+e.getAttribute("onclick")+'" style="cursor:pointer;">'+e.getAttribute("title")+"</li>",t++);n+="</ul></div></div>",t>0&&r.insertAdjacentHTML("beforebegin",n);var o=document.querySelector(".scValidatorPanel"),i=new MutationObserver((function(e){t=0;var n='<div id="scMessageBarError" class="scMessageBar scError"><div class="scMessageBarIcon" style="background-image:url('+s+')"></div><div class="scMessageBarTextContainer"><ul class="scMessageBarOptions" style="margin:0px">';for(let e of a)"/sitecore/shell/themes/standard/images/bullet_square_yellow.png"!=e.getAttribute("src")&&(n+='<li class="scMessageBarOptionBullet" onclick="'+e.getAttribute("onclick")+'" style="cursor:pointer;">'+e.getAttribute("title")+"</li>",t++);if(n+="</ul></div></div>",t>0)r.insertAdjacentHTML("beforebegin",n);else{var o=document.getElementById("scMessageBarError");o&&o.parentNode.removeChild(o)}debug&&console.log("!! Change !!")}));if(o){i.observe(o,{attributes:!0,childList:!0,characterData:!0})}}}))}isGalleryLanguage?(debug&&console.info("====================> LANGUAGES <===================="),chrome.storage.sync.get(["feature_flags"],(function(e){if(null==e.feature_flags&&(e.feature_flags=!0),e.feature_flags){var t,a=new XMLHttpRequest;a.overrideMimeType("application/json"),a.open("GET",chrome.runtime.getURL("data/languages.json"),!0),a.onreadystatechange=function(){if(4===a.readyState&&"200"==a.status){t=JSON.parse(a.responseText);var e,r,s,n,o,i=document.getElementById("Languages").querySelectorAll(".scMenuPanelItem,.scMenuPanelItemSelected"),c=0;for(let a of i){c=0,e=a.getElementsByTagName("td");for(let a of e){if(0==c)s=a.getElementsByTagName("img");else{if(r=(r=a.getElementsByTagName("b"))[0].innerHTML,"0"!=a.getElementsByTagName("div")[2].innerHTML.split(" ")[0]&&(n=a.getElementsByTagName("div"))[2].setAttribute("style","background-color: yellow; display: initial; padding: 0px 3px; color: #000000 !important"),r.includes("(region)"))for(o in r=r.split(" (region"),t)t.hasOwnProperty(o)&&r[0].toUpperCase()==t[o].language.toUpperCase()&&(r=t[o].flag);else(n=(n=(n=null==(n=r.split(" ("))[1]?n[0]:n[1]).split(")"))[0].split(" :"))[0].includes(", ")&&((n=n[0].split(", "))[0]=n[1],n[0]=n[0].replace(" ","_")),r=(r=(r=(r=(r=(r=(r=(n=(n=n[0].replace(" ","_")).toUpperCase()).replace("TRADITIONAL,_","")).replace("SIMPLIFIED,_","")).replace("U.A.E.","UNITED_ARAB_EMIRATES")).replace("KOREA","SOUTH_KOREA")).replace("UNITED_STATES","USA")).replace("UNITED_KINGDOM","GREAT_BRITAIN")).replace("ENGLISH","GREAT_BRITAIN");r=r.toLowerCase(),s[0].onerror=function(){this.src=chrome.runtime.getURL("images/Flags/32x32/flag_generic.png")},s[0].src=chrome.runtime.getURL("images/Flags/32x32/flag_"+r+".png")}c++}0}}},a.send(null)}}))):isGalleryLanguageExpEd?(debug&&console.info("====================> LANGUAGES IN EXPERIENCE EDITOR <===================="),chrome.storage.sync.get(["feature_flags"],(function(e){if(null==e.feature_flags&&(e.feature_flags=!0),e.feature_flags){var t,a=new XMLHttpRequest;a.overrideMimeType("application/json"),a.open("GET",chrome.runtime.getURL("data/languages.json"),!0),a.onreadystatechange=function(){if(4===a.readyState&&"200"==a.status){t=JSON.parse(a.responseText);var e,r,s,n,o,i=document.querySelector(".sc-gallery-content").querySelectorAll(".sc-gallery-option-content,.sc-gallery-option-content-active");for(let a of i){for(o in e=a.closest(".sc-gallery-option-content,.sc-gallery-option-content-active"),r=a.querySelector(".sc-gallery-option-content-header > span"),"0"!=(n=(s=a.querySelector(".sc-gallery-option-content-description > span")).innerHTML.split(" "))[0]&&s.setAttribute("style","background-color: yellow; display: initial; padding: 0px 3px; color: #000000 !important"),(n=(n=null==(n=(n=r.innerHTML.split(" :"))[0].split(" ("))[1]?n[0]:n[1]).split(")"))[0].includes(", ")&&((n=n[0].split(", "))[0]=n[1],n[0]=n[0].replace(" ","_")),r=(r=(r=(r=(r=(r=(r=(n=(n=n[0].replace(" ","_")).toUpperCase()).replace("TRADITIONAL,_","")).replace("SIMPLIFIED,_","")).replace("U.A.E.","UNITED_ARAB_EMIRATES")).replace("KOREA","SOUTH_KOREA")).replace("UNITED_STATES","USA")).replace("UNITED_KINGDOM","GREAT_BRITAIN")).replace("ENGLISH","GREAT_BRITAIN"),t)t.hasOwnProperty(o)&&r==t[o].language.toUpperCase()&&(r=t[o].flag);e.setAttribute("style","padding-left:48px; background-image: url("+chrome.runtime.getURL("images/Flags/32x32/flag_"+r+".png")+"); background-repeat: no-repeat; background-position: 5px;")}}},a.send(null)}}))):isPublishWindow&&(debug&&console.info("====================> PUBLISH WINDOW <===================="),chrome.storage.sync.get(["feature_flags"],(function(e){if(null==e.feature_flags&&(e.feature_flags=!0),e.feature_flags){var t,a,r,s,n=document.getElementById("Languages").getElementsByTagName("label"),o=new XMLHttpRequest;o.overrideMimeType("application/json"),o.open("GET",chrome.runtime.getURL("data/languages.json"),!0),o.onreadystatechange=function(){if(4===o.readyState&&"200"==o.status){s=JSON.parse(o.responseText);for(let e of n){for(r in(t=(t=null==(t=(t=e.innerText.split(" :"))[0].split(" ("))[1]?t[0]:t[1]).split(")"))[0].includes(", ")&&((t=t[0].split(", "))[0]=t[1],t[0]=t[0].replace(" ","_")),t=(t=t[0].replace(" ","_")).toUpperCase(),a=(a=(a=(a=(a=(a=(a=t.replace("TRADITIONAL,_","")).replace("SIMPLIFIED,_","")).replace("U.A.E.","UNITED_ARAB_EMIRATES")).replace("KOREA","SOUTH_KOREA")).replace("UNITED_STATES","USA")).replace("UNITED_KINGDOM","GREAT_BRITAIN")).replace("ENGLISH","GREAT_BRITAIN"),s)s.hasOwnProperty(r)&&a==s[r].language.toUpperCase()&&(a=s[r].flag);e.insertAdjacentHTML("afterend",' <img id="scFlag" src="-/icon/Flags/16x16/flag_'+a+'.png" style="display: inline; vertical-align: middle; padding-right: 2px;" onerror="this.onerror=null;this.src=\'-/icon/Flags/16x16/flag_generic.png\';"/>')}}},o.send(null)}}))),chrome.storage.sync.get(["feature_darkmode"],(function(e){if(null==e.feature_darkmode&&(e.feature_darkmode=!1),e.feature_darkmode&&!isExperienceEditor&&!isAdminCache&&!isSecurityWindow&&!isContentHome&&!isLoginPage&&!isEditMode){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/default-min.css"),document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("link")).type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/ribbon-min.css"),document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("link")).type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/contentmanager-min.css"),document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("link")).type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/dialogs-min.css"),document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("link")).type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/gallery-min.css"),document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("link")).type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/speak-min.css"),document.getElementsByTagName("head")[0].appendChild(t)}}));var MutationObserver=window.MutationObserver,elementObserver=new MutationObserver((function(e){debug&&console.info("%c *** Update UI *** ","font-size:14px; background: #ffce42; color: black; border-radius:5px; padding 3px;");var t=document.querySelector(".scEditorHeaderQuickInfoInput");if(t){var a=t.getAttribute("value"),r=document.getElementById("scLanguage").getAttribute("value").toLowerCase(),s=document.querySelector(".scEditorHeaderVersionsVersion > span").innerText,n=document.querySelectorAll(".scEditorQuickInfo"),o=(n[n.length-1],n.length),i=document.getElementsByClassName("scEditorHeaderTitle"),c=document.querySelectorAll(".scEditorHeaderQuickInfoInput"),l=c[c.length-2].getAttribute("value");if(window.location.hash=a,debug&&console.info("%c - Tabs opened: "+o+" ","font-size:12px; background: #7b3090; color: white; border-radius:5px; padding 3px;"),o>1&&!document.getElementById("showInContentTree"+o)){var d=window.location.href;d=d.split("#");var u=d[0]+"&reload#"+l;i[o-1].insertAdjacentHTML("afterend",'[<a id="showInContentTree'+o+'" href="" onclick="javascript:window.location.href=\''+u+"'; return false;\" />Show in content tree</a>]")}chrome.storage.sync.set({scItemID:a},(function(){debug&&console.info("%c [Storage Set] Item : "+a+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;")})),chrome.storage.sync.set({scLanguage:r},(function(){debug&&console.info("%c [Storage Set] Language : "+r+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;")})),chrome.storage.sync.set({scVersion:s},(function(){debug&&console.info("%c [Storage Set] Version : "+s+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;")}))}e.forEach((function(e){"attributes"==e.type&&sitecoreAuthorToolbox()}))})),element=document.getElementById("scLanguage");if(element){debug&&console.info("%c *** Reload *** ","font-size:14px; background: #ffce42; color: black; border-radius:5px; padding 3px;");var scVersion,scLanguage=element.getAttribute("value").toLowerCase(),hash=window.location.hash.substr(1);if(""!=hash){var actualCode='scForm.invoke("item:load(id='+hash+",language="+scLanguage+',version=1)");';(script=document.createElement("script")).textContent=actualCode,(document.head||document.documentElement).appendChild(script),script.remove(),debug&&console.info("%c - Sitecore Hash : "+hash+" ","font-size:12px; background: #7b3090; color: white; border-radius:5px; padding 3px;")}else chrome.storage.sync.get(["scItemID","scLanguage","scVersion","feature_reloadnode"],(function(e){if(!chrome.runtime.error&&null!=e.scItemID&&(null==e.feature_reloadnode&&(e.feature_reloadnode=!0),e.scItemID&&1==e.feature_reloadnode)){var t='scForm.invoke("item:load(id='+e.scItemID+",language="+scLanguage+",version="+scVersion+')");',a=document.createElement("script");a.textContent=t,(document.head||document.documentElement).appendChild(a),a.remove(),debug&&console.info("%c [Storage Get] Item : "+e.scItemID+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;"),debug&&console.info("%c [Storage Get] Language : "+e.scLanguage+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;"),debug&&console.info("%c [Storage Get] Version : "+e.scVersion+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;")}}));sitecoreAuthorToolbox(),elementObserver.observe(element,{attributes:!0})}var elementObserver2=new MutationObserver((function(e){chrome.storage.sync.get(["feature_notification"],(function(e){if(null==e.feature_notification&&(e.feature_notification=!0),e.feature_notification){element2.getElementsByClassName("DialogHeader").item(0).innerHTML;sendNotification(element2.getElementsByClassName("sc-text-largevalue").item(0).innerHTML,element2.getElementsByClassName("scFieldLabel").item(0).innerHTML)}})),debug&&console.info("%c *** Publish Done *** ","font-size:14px; background: #ffce42; color: black; border-radius:5px; padding 3px;")})),element2=document.getElementById("LastPage");element2&&(debug&&console.info("%c *** Open Dialog *** ","font-size:14px; background: #ffce42; color: black; border-radius:5px; padding 3px;"),elementObserver2.observe(element2,{attributes:!0}))}if(isEditMode&&!isRibbon){debug&&console.info("%c 🎨 Experience Editor detected ","font-size:14px; background: #f16100; color: black; border-radius:5px; padding 3px;"),(link=document.createElement("link")).type="text/css",link.rel="stylesheet",link.href=chrome.runtime.getURL("css/tooltip-min.css"),document.getElementsByTagName("head")[0].appendChild(link);var observer=new MutationObserver((function(e){var t=document.querySelectorAll(".scChromeToolbar");for(var a of t){a.setAttribute("style","margin-left:50px");var r=a.querySelectorAll(".scChromeCommand");for(var s of r){var n=s.getAttribute("title");s.setAttribute("style","z-index:auto"),null!=n&&(s.setAttribute("data-tooltip",n),s.classList.add("t-bottom"),s.classList.add("t-sm"),
s.removeAttribute("title"))}}})),target=document.querySelector(".scChromeControls");if(target){var config={attributes:!0,childList:!0,characterData:!0};observer.observe(target,config)}}