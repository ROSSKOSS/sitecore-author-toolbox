const debug=!0,icon=chrome.runtime.getURL("images/rocket.svg"),iconLock=chrome.runtime.getURL("images/lock.svg"),iconWorkflow=chrome.runtime.getURL("images/workflow.svg"),iconPublish=chrome.runtime.getURL("images/publish.svg"),iconUnicorn=chrome.runtime.getURL("images/unicorn.svg"),iconUser=chrome.runtime.getURL("images/user.svg"),iconError=chrome.runtime.getURL("images/error.svg"),iconEdit=chrome.runtime.getURL("images/edit.svg"),iconMedia=chrome.runtime.getURL("images/media.svg"),iconTranslate=chrome.runtime.getURL("images/translate.svg"),iconFlagGeneric=chrome.runtime.getURL("images/Flags/32x32/flag_generic.png"),urlLoader=chrome.runtime.getURL("images/ajax-loader.gif"),dotGreen=chrome.runtime.getURL("images/dot_green.svg"),dotRed=chrome.runtime.getURL("images/dot_red.svg"),iconEE=chrome.runtime.getURL("images/sat.png"),iconCE=chrome.runtime.getURL("images/ce.png"),rteLanguages=["ARABIC","HEBREW","PERSIAN","URDU","SINDHI"],windowLocationHref=window.location.href.toLowerCase(),launchpadPage=chrome.runtime.getURL("options.html"),launchpadIcon=chrome.runtime.getURL("images/icon.png"),launchpadGroupTitle="Sitecore Author Toolbox",launchpadTitle="Options";let initX,initY,mousePressX,target,script,link,isSitecore=window.location.pathname.includes("/sitecore/"),isPreviewMode=document.querySelector(".pagemode-preview");isPreviewMode||(isPreviewMode=windowLocationHref.includes("sc_mode=preview"));let isEditMode=document.querySelector(".pagemode-edit");isEditMode||(isEditMode=windowLocationHref.includes("sc_mode=edit")),isEditMode||(isEditMode=windowLocationHref.includes("/experienceeditor/"));let isGalleryLanguage=windowLocationHref.includes("gallery.language"),isGalleryLanguageExpEd=windowLocationHref.includes("selectlanguagegallery"),isGalleryFavorites=windowLocationHref.includes("gallery.favorites"),isGalleryVersions=windowLocationHref.includes("gallery.versions"),isAdminCache=windowLocationHref.includes("/admin/cache.aspx"),isAdmin=windowLocationHref.includes("/admin/"),isMediaBrowser=windowLocationHref.includes("sitecore.shell.applications.media.mediabrowser"),isPublishWindow=windowLocationHref.includes("/shell/applications/publish.aspx"),isSecurityWindow=windowLocationHref.includes("/shell/applications/security/"),isContentEditor=document.querySelector("#scLanguage"),isExperienceEditor=windowLocationHref.includes("/applications/experienceeditor/"),isContentHome=windowLocationHref.includes("/content/"),isLoginPage=windowLocationHref.includes("sitecore/login"),isLaunchpad=windowLocationHref.includes("/client/applications/launchpad"),isDesktop=windowLocationHref.includes("/shell/default.aspx"),isRichTextEditor=windowLocationHref.includes("/controls/rich%20text%20editor/"),isHtmlEditor=windowLocationHref.includes(".edithtml.aspx"),isFieldEditor=windowLocationHref.includes("field%20editor.aspx"),isModalDialogs=windowLocationHref.includes("jquerymodaldialogs.html"),isSecurityDetails=windowLocationHref.includes("securitydetails.aspx"),isEditorFolder=windowLocationHref.includes("editors.folder.aspx"),isRibbon=windowLocationHref.includes("/ribbon.aspx"),isDialog=windowLocationHref.includes("experienceeditor/dialogs/confirm/"),isInsertPage=windowLocationHref.includes("/dialogs/insertpage/"),isCreateUser=windowLocationHref.includes("createnewuser"),isUserManager=windowLocationHref.includes("user%20manager.aspx"),isPersonalization=windowLocationHref.includes("dialogs.personalization"),isRules=windowLocationHref.includes("rules.aspx"),isCss=windowLocationHref.includes(".css"),isSearch=windowLocationHref.includes("showresult.aspx"),scQuickInfo=document.querySelector(".scEditorHeaderQuickInfoInput"),scUrlHash=window.location.hash.substr(1),workboxLaunchpad=document.querySelector("a[title='Workbox']"),workboxPage="/sitecore/shell/Applications/Workbox/Default.aspx?he=Workbox&sc_bw=1",hasRedirection=windowLocationHref.includes("&ro="),hasRedirectionOther=windowLocationHref.includes("&sc_ce_uri="),scContentTree=document.querySelector("#ContentTreeHolder");const jsonData=JSON.parse('[{"language":"Afrikaans","flag":"SOUTH_AFRICA"},{"language":"Arabic","flag":"SAUDI_ARABIA"},{"language":"Belarusian","flag":"BELARUS"},{"language":"Bulgarian","flag":"BULGARIA"},{"language":"Catalan","flag":""},{"language":"Czech","flag":"CZECH_REPUBLIC"},{"language":"Danish","flag":"DENMARK"},{"language":"German","flag":"GERMANY"},{"language":"Greek","flag":"GREECE"},{"language":"English","flag":"GREAT_BRITAIN"},{"language":"Spanish","flag":"SPAIN"},{"language":"Estonian","flag":"ESTONIA"},{"language":"Basque","flag":""},{"language":"Persian","flag":"IRAN"},{"language":"Finnish","flag":"FINLAND"},{"language":"Faroese","flag":""},{"language":"French","flag":"FRANCE"},{"language":"Galician","flag":""},{"language":"Gujarati","flag":"INDIA"},{"language":"Hebrew","flag":"ISRAEL"},{"language":"Hindi","flag":"INDIA"},{"language":"Croatian","flag":"CROATIA"},{"language":"Hungarian","flag":"HUNGARY"},{"language":"Armenian","flag":"ARMENIA"},{"language":"Indonesian","flag":"MAIN_COUNTRY"},{"language":"Icelandic","flag":"ICELAND"},{"language":"Italian","flag":"ITALY"},{"language":"Japanese","flag":"JAPAN"},{"language":"Georgian","flag":"GEORGIA"},{"language":"Kazakh","flag":"KAZAKHSTAN"},{"language":"Kannada","flag":"INDIA"},{"language":"Korean","flag":"SOUTH_KOREA"},{"language":"Kyrgyz","flag":"KYRGYZSTAN"},{"language":"Lithuanian","flag":"LITHUANIA"},{"language":"Latvian","flag":"LATVIA"},{"language":"Maori","flag":"NEW_ZEALAND"},{"language":"Macedonian","flag":"MACEDONIA"},{"language":"Mongolian","flag":"MONGOLIA"},{"language":"Marathi","flag":"INDIA"},{"language":"Malay","flag":"MALAYSIA"},{"language":"Maltese","flag":"MALTA"},{"language":"Norwegian Bokm√•l","flag":"NORWAY"},{"language":"Dutch","flag":"NETHERLANDS"},{"language":"Norwegian Nynorsk","flag":"NORWAY"},{"language":"Punjabi","flag":"INDIA"},{"language":"Polish","flag":"POLAND"},{"language":"Portuguese","flag":"PORTUGAL"},{"language":"Romanian","flag":"ROMANIA"},{"language":"Russian","flag":"RUSSIA"},{"language":"Sanskrit","flag":"INDIA"},{"language":"Sami, Northern","flag":""},{"language":"Slovak","flag":"SLOVAKIA"},{"language":"Slovenian","flag":"SLOVENIA"},{"language":"Albanian","flag":"ALBANIA"},{"language":"Swedish","flag":"SWEDEN"},{"language":"Kiswahili","flag":"KENYA"},{"language":"Tamil","flag":"INDIA"},{"language":"Telugu","flag":"INDIA"},{"language":"Thai","flag":"THAILAND"},{"language":"Setswana","flag":"SOUTH_AFRICA"},{"language":"Turkish","flag":"TURKEY"},{"language":"Tatar","flag":"RUSSIA"},{"language":"Ukrainian","flag":"UKRAINE"},{"language":"Urdu","flag":"PAKISTAN"},{"language":"Vietnamese","flag":"VIETNAM"},{"language":"isiXhosa","flag":"SOUTH_AFRICA"},{"language":"Chinese","flag":"CHINA"},{"language":"isiZulu","flag":"SOUTH_AFRICA"}]');function stripHtml(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}function showSnackbar(e){var t='<div class="snackbar"> <b>Live URL has been improved.</b><br />You can now setup your CM or CD/Live domains.<br />Clic the settings button. <button onclick="window.location.href =\' '+launchpadPage+"?configure_domains=true&launchpad=true&url= "+windowLocationHref+' &tabs=0 \'">SETTINGS</button><button id="sbDismiss">DISMISS</button></div>';document.querySelector("body").insertAdjacentHTML("beforeend",t),document.querySelector("#sbDismiss").addEventListener("click",(function(){chrome.runtime.sendMessage({greeting:"hide_snackbar",version:e},(function(e){null!=e.farewell&&document.querySelector(".snackbar").setAttribute("style","display: none")}))}))}function checkWorkbox(){var e=new XMLHttpRequest;e.timeout=7e3,e.open("GET","/sitecore/shell/default.aspx?xmlcontrol=Workbox",!0),e.onreadystatechange=function(){if(4===e.readyState&&"200"==e.status){var t=(new DOMParser).parseFromString(e.responseText,"text/html"),a=t.querySelectorAll("#States > div"),r=0,o="#checksum#",n=t.querySelectorAll(".scWorkflowsPanel > div > span > input");for(var s of n)s.checked&&0;for(var i of a){1,o+="-workflow:"+i.querySelector(".scPaneHeader").innerText.replace(" ","").toLowerCase();var c=i.querySelectorAll(".scBackground");for(var l of c){var d=l.querySelector(".scSectionCenter").innerText,u=(l.querySelectorAll(".scWorkBoxData"),d.split(" - (")[1].toLowerCase());"none"==(u=u.replace(")","").replace(" item","").replace("s",""))&&(u=0),r+=parseInt(u),o+="-state:"+d.split(" - ")[0].replace(" ","").toLowerCase()+":"+r}}var g=sessionStorage.getItem("wfChecksum");if(sessionStorage.setItem("wfChecksum",o),g!=o&&r>0){sendNotification("Workflow changes detected","Check your workbox!")}if(isLaunchpad)t='<span class="launchpadBadge">'+r+"</span>",workboxLaunchpad.insertAdjacentHTML("afterbegin",t);else{var p=document.querySelectorAll(".scDockBottom > a");for(var m of p){var f=m.innerText;"Workbox"==f&&(t='<span class="wbNotification">'+r+"</span>",m.setAttribute("style","padding-right:35px"),m.insertAdjacentHTML("afterend",t))}}}else if(4===e.readyState&&"0"==e.status)if(isLaunchpad)t='<span class="launchpadBadge">?</span>',workboxLaunchpad.insertAdjacentHTML("afterbegin",t);else for(m of p=document.querySelectorAll(".scDockBottom > a"))"Workbox"==(f=m.innerText)&&(t='<span class="wbNotification">?</span>',m.setAttribute("style","padding-right:35px"),m.insertAdjacentHTML("afterend",t))},e.send(null)}function checkUrlStatus(e=null){var t,a,r=!1;if(null==e?document.querySelector(".sitecoreItemPath")&&(r=document.querySelector(".sitecoreItemPath").href,t=document.querySelector(".liveUrlStatus")):e.querySelector(".sitecoreItemPath")&&(r=e.querySelector(".sitecoreItemPath").href,t=e.querySelector(".liveUrlStatus")),t&&(t.innerHTML='<img src="'+urlLoader+'" style="width: 10px; float: initial; margin: unset;"/>'),r){var o=new Request(r);fetch(o).then((function(r){t=null==e?document.querySelector(".liveUrlStatus"):e.querySelector(".liveUrlStatus"),a="404"==r.status||"500"==r.status?"<span class='liveStatusRed'><img src=' "+dotRed+"'/> Not available ("+r.status+")</span>":"<span class='liveStatusGreen'><img src=' "+dotGreen+"'/> Published</span>",t.innerHTML=t?a:""}))}}function sendNotification(e,t){new Notification(e,{body:t,icon:chrome.runtime.getURL("images/icon.png")});var a=new Audio(chrome.runtime.getURL("audio/notification.mp3")).play();void 0!==a&&a.then(e=>{}).catch(e=>{})}function repositionElement(e){this.style.left=initX+e.clientX-mousePressX+"px"}function startDrag(){var e=document.querySelector(".scExpTab");e&&e.addEventListener("mousedown",(function(t){initX=this.offsetLeft,mousePressX=t.clientX,this.addEventListener("mousemove",repositionElement,!1),window.addEventListener("mouseup",(function(){e.removeEventListener("mousemove",repositionElement,!1)}),!1)}),!1)}function cleanCountryName(e){var t=e;return""!=t&&t.includes(" :")&&(t=(t=t.split(" :"))[0]),(t=(t=null==(t=t.split(" ("))[1]?t[0]:t[1]).split(")"))[0].includes(", ")&&((t=t[0].split(", "))[0]=t[1],t[0]=t[0].replace(" ","_")),(t=(t=t[0].replace(" ","_")).toUpperCase()).replace("TRADITIONAL,_","").replace("SIMPLIFIED,_","").replace("U.A.E.","UNITED_ARAB_EMIRATES").replace("KOREA","SOUTH_KOREA").replace("UNITED_STATES","USA").replace("UNITED_KINGDOM","GREAT_BRITAIN").replace("ENGLISH","GREAT_BRITAIN")}function sitecoreAuthorToolbox(){var e=0;let t=document.querySelector(".scEditorHeader");document.querySelector(".scEditorHeaderTitle");document.querySelector(".scEditorQuickInfo");let a=document.querySelector(".scEditorHeaderQuickInfoInput"),r=document.querySelector(".scEditorHeaderVersionsLanguage"),o=document.querySelector(".scEditorHeaderVersionsVersion > span");o&&(o=o.innerText);let n=window.location.hash.substr(1),s=document.querySelector(".scEditorTabHeaderActive");document.querySelectorAll(".scRibbonEditorTabNormal");var i=document.querySelectorAll(" .scValidationMarkerIcon ");document.querySelector(" .scValidationResult ");let c=document.querySelector("#EditorFrames"),l=document.querySelector(".scEditorSections"),d=(document.querySelector("#SearchPanel"),!1);var u=document.querySelector(".scEditorHeaderVersionsLanguage");if(u)var g=u.getAttribute("title"),p=stripHtml(u.innerHTML);if(a){var m=document.getElementsByClassName("scEditorHeaderQuickInfoInput"),f=m[0].getAttribute("value"),h=m[1].getAttribute("value").toLowerCase()+"/",b=(m[1].getAttribute("value").toLowerCase(),h.toLowerCase()+"/"),y=(h=h.split("/home/"))[0].toLowerCase();y=(y=y.split("/")).slice(-1)[0];var v,x=b.includes("/data/"),L=(b.includes("/marketing control panel/"),b.includes("/sitecore/templates"),b.includes("/sitecore/system"),b.includes("/sitecore/layout"),b.includes("/sitecore/forms"),b.includes("/presentation"),b.includes("/sitecore/content")),k=b.includes("/sitecore/media library"),S=document.getElementById("scLanguage").getAttribute("value").toLowerCase(),w=window.location.origin+"/?sc_itemid="+f+"&sc_mode=normal&sc_lang="+S+"&sc_version="+o,A=p.includes("(");h=null!=h[1]?encodeURI(window.location.origin+"/"+S+"/"+h[1]+"?sc_site=xxxsxa_sitexxx&sc_mode=normal").toLowerCase():encodeURI(window.location.origin+"/"+S+"/?sc_site=xxxsxa_sitexxx&sc_mode=normal").toLowerCase(),L&&!x||k?chrome.storage.sync.get(["feature_urls","domain_manager","feature_urlstatus"],(function(e){null==e.feature_urls&&(e.feature_urls=!0),null==e.feature_urlstatus&&(e.feature_urlstatus=!0);var a=void 0,r=e.domain_manager,n="CM server";for(var s in r)if(window.location.origin==s){a=r[s];break}!document.querySelector("#scMessageBarUrl")&&e.feature_urls&&chrome.runtime.sendMessage({greeting:"sxa_site"},(function(r){if(null!=r.farewell){var s=y.toLowerCase(),i=r.farewell.toLowerCase(),c=i.includes(s);debug&&console.log("%c - QuickInfo ("+s+") VS Cookie ("+i+") = "+c+" ","font-size:12px; background: #e3658e; color: black; border-radius:5px; padding 3px;")}var l;if(null!=r.farewell&&c&&null==a?h=h.replace("xxxsxa_sitexxx",r.farewell):null==a?h=h.replace("sc_site=xxxsxa_sitexxx&",""):null!=a&&(h=(h=(h=h.replace("sc_site=xxxsxa_sitexxx&","")).replace("?sc_mode=normal","")).replace(window.location.origin,a),w=(w=w.replace(window.location.origin,a)).replace("&sc_mode=normal",""),n="CD/Live server"),k){var d=f.replace(/-/g,"").replace("{","").replace("}","");h=window.location.origin+"/sitecore/shell/Applications/-/media/"+d+".ashx?vs="+o+"&ts="+Math.round(1e5*Math.random()),l='<div id="scMessageBarUrl" class="scMessageBar scWarning"><div class="scMessageBarIcon" style="background-image:url('+iconMedia+')"></div><div class="scMessageBarTextContainer"><div class="scMessageBarTitle">Media Live URL</div><div class="scMessageBarText">If you want to preview this media</div><ul class="scMessageBarOptions" style="margin:0px"><li class="scMessageBarOptionBullet"><a href="'+h+'" target="_blank" class="scMessageBarOption sitecoreItemPath">Open this media</a></li></ul></div></div>'}else l='<div id="scMessageBarUrl" class="scMessageBar scWarning"><div class="scMessageBarIcon" style="background-image:url('+icon+')"></div><div class="scMessageBarTextContainer"><div class="scMessageBarTitle">Sitecore Live URL <span class="liveUrlBadge" onclick="location.href = \''+launchpadPage+"?configure_domains=true&launchpad=true&url="+windowLocationHref+'\'" title="Click to configure your domains">'+n+'</span> <span class="liveUrlStatus"></span></div><div class="scMessageBarText">If you want to preview this page in <b>'+g+"</b> (version "+o+')</div><ul class="scMessageBarOptions" style="margin:0px"><li class="scMessageBarOptionBullet"><a href="'+h+'" target="_blank" class="scMessageBarOption sitecoreItemPath">Open this link</a> or try <a href="'+w+'" target="_blank" class="scMessageBarOption">this alternative link</a></li></ul></div></div>';t.insertAdjacentHTML("afterend",l),e.feature_urlstatus&&!k&&setTimeout((function(){checkUrlStatus()}),500)}))})):x&&chrome.storage.sync.get(["feature_urls"],(function(e){if(null==e.feature_urls&&(e.feature_urls=!0),!document.getElementById("scMessageBarInfo")&&e.feature_urls){var a='<div id="scMessageBarInfo" class="scMessageBar scInformation"><div class="scMessageBarIcon" style="background-image:url('+iconEdit+')"></div><div class="scMessageBarTextContainer"><div class="scMessageBarTitle">You are editing a data source...</div><div class="scMessageBarText">To see it, you need to add/edit it to any page via the</b></div><ul class="scMessageBarOptions" style="margin:0px"><li class="scMessageBarOptionBullet"><span class="scMessageBarOption">Presentation Details</span> or <span class="scMessageBarOption">Experience Editor</span></li></ul></div></div>';t.insertAdjacentHTML("afterend",a)}}))}else if(!document.querySelector("#scMessageBarUrl")&&l){var E='<div id="scMessageBarUrl" class="scMessageBar scWarning"><div class="scMessageBarIcon" style="background-image:url('+icon+')"></div><div class="scMessageBarTextContainer"><div class="scMessageBarTitle">Oh snap! üò≠üò≠üò≠</div><div class="scMessageBarText">To fully enjoy Sitecore Author Toolbox, please enable <b>Title bar</b> and <b>Quick info section</b> under <b>Application Options</b>.</div><ul class="scMessageBarOptions" style="margin:0px"><li class="scMessageBarOptionBullet"><a href="" onclick="javascript:return scForm.postEvent(this,event,\'shell:useroptions\')" class="scMessageBarOption">Open Application Options</a>.</li></ul></div></div>';l.insertAdjacentHTML("afterbegin",E)}chrome.storage.sync.get(["feature_flags"],(function(e){null==e.feature_flags&&(e.feature_flags=!0);var t=document.querySelector(".scEditorHeaderVersionsVersion");if(t){var a=t.getAttribute("title");t.querySelector("span").innerText=a.replace("."," ‚ñæ")}if(A)v=(v=cleanCountryName(p)).toLowerCase(),v=chrome.runtime.getURL("images/Flags/32x32/flag_"+v+".png"),!document.querySelector("#scFlag")&&e.feature_flags&&v&&s.insertAdjacentHTML("afterbegin",'<img id="scFlag" src="'+v+'" style="width: 20px; vertical-align: middle; padding: 0px 5px 0px 0px;" onerror="this.onerror=null;this.src=\''+iconFlagGeneric+"';\"/>"),!document.querySelector("#scFlagMenu")&&e.feature_flags&&v&&r.insertAdjacentHTML("afterbegin",'<img id="scFlagMenu" src="'+v+'" style="width: 15px; vertical-align: sub; padding: 0px 5px 0px 0px;" onerror="this.onerror=null;this.src=\''+iconFlagGeneric+"';\"/>");else if(e.feature_flags)for(let t in jsonData)jsonData.hasOwnProperty(t)&&p&&p.toUpperCase()==jsonData[t].language.toUpperCase()&&(v=(v=jsonData[t].flag).toLowerCase(),v=chrome.runtime.getURL("images/Flags/32x32/flag_"+v+".png"),!document.querySelector("#scFlag")&&e.feature_flags&&v&&s.insertAdjacentHTML("afterbegin",'<img id="scFlag" src="'+v+'" style="width: 20px; vertical-align: middle; padding: 0px 5px 0px 0px;" onerror="this.onerror=null;this.src=\''+iconFlagGeneric+"';\"/>"),!document.querySelector("#scFlagMenu")&&e.feature_flags&&v&&r.insertAdjacentHTML("afterbegin",'<img id="scFlagMenu" src="'+v+'" style="width: 15px; vertical-align: sub; padding: 0px 5px 0px 0px;" onerror="this.onerror=null;this.src=\''+iconFlagGeneric+"';\"/>"))})),chrome.storage.sync.get(["feature_rtl"],(function(e){if(null==e.feature_rtl&&(e.feature_rtl=!0),e.feature_rtl&&p){var t;if(m=p.split(" ("),v=m[0].toUpperCase(),(link=document.createElement("link")).type="text/css",link.rel="stylesheet",rteLanguages.includes(v)){link.href=chrome.runtime.getURL("css/rtl-min.css"),t=document.getElementsByClassName("scContentControlHtml");for(let e of t)e.onload=function(){e.contentWindow.document.getElementById("ContentWrapper").style.direction="RTL"}}else{link.href=chrome.runtime.getURL("css/ltr-min.css"),t=document.getElementsByClassName("scContentControlHtml");for(let e of t)e.onload=function(){e.contentWindow.document.getElementById("ContentWrapper").style.direction="LTR"}}document.getElementsByTagName("head")[0].appendChild(link)}})),chrome.storage.sync.get(["feature_errors"],(function(a){if(null==a.feature_errors&&(a.feature_errors=!0),a.feature_errors){e=0;var r='<div id="scMessageBarError" class="scMessageBar scError"><div class="scMessageBarIcon" style="background-image:url('+iconError+')"></div><div class="scMessageBarTextContainer"><ul class="scMessageBarOptions" style="margin:0px">';for(let t of i){var o=t.previousSibling;if(o){var n=o.closest("div").getAttribute("id").replace("ValidationMarker",""),s=(document.querySelector("#"+n).closest("table").closest("td").closest("table").previousSibling.innerText,document.querySelector("#"+n).closest("table").closest("td").closest("table").previousSibling.getAttribute("id"));document.querySelectorAll('[data-id="'+s+'"]');"/sitecore/shell/themes/standard/images/bullet_square_yellow.png"!=t.getAttribute("src")&&(r+='<li class="scMessageBarOptionBullet" onclick="'+t.getAttribute("onclick")+'" style="cursor:pointer;">'+t.getAttribute("title")+"</li>",e++)}}r+="</ul></div></div>",e>0&&t.insertAdjacentHTML("afterend",r);var c=document.querySelector(".scValidatorPanel"),l=new MutationObserver((function(a){e=0;var r='<div id="scMessageBarError" class="scMessageBar scError"><div class="scMessageBarIcon" style="background-image:url('+iconError+')"></div><div class="scMessageBarTextContainer"><ul class="scMessageBarOptions" style="margin:0px">';for(let t of i)"/sitecore/shell/themes/standard/images/bullet_square_yellow.png"!=t.getAttribute("src")&&(r+='<li class="scMessageBarOptionBullet" onclick="'+t.getAttribute("onclick")+'" style="cursor:pointer;">'+t.getAttribute("title")+"</li>",e++);if(r+="</ul></div></div>",e>0)t.insertAdjacentHTML("afterend",r);else{var o=document.querySelector("#scMessageBarError");o&&o.parentNode.removeChild(o)}debug&&console.log("Changement: "+document.querySelector(".scValidatorPanel"))}));if(c){l.observe(c,{attributes:!0,childList:!0,characterData:!0})}}}));var M=document.querySelector("#EditorFrames");if(M){var T,_,B;M=M.querySelectorAll("iframe"),e=0;for(let t of M)if(T=M[e].src,_=M[e],B=T.includes("/Media/"),e++,B){debug&&console.info("SRC of MEDIA IFRAME "+e+" - "+T);break}chrome.storage.sync.get(["feature_dragdrop"],(function(e){if(null==e.feature_dragdrop&&(e.feature_dragdrop=!0),B&&e.feature_dragdrop)_.onload=function(){var e=(T=(T=(T=T.split("id=%7B"))[1].split("%7B"))[0].split("%7D"))[0];debug&&console.info(e);var t='<iframe id="sitecorAuthorToolbox" class="sitecorAuthorToolbox" src="'+("/sitecore/client/Applications/Dialogs/UploadMediaDialog?ref=list&ro=sitecore://master/%7b"+e+"%7d%3flang%3den&fo=sitecore://master/%7b"+e+"%7d")+'" style="width:100%; height:500px; margin-top: -60px; resize: vertical;"></iframe>';_.setAttribute("style","margin-top: -30px;");var a=document.querySelector("#sitecorAuthorToolbox");a&&a.remove(),c.insertAdjacentHTML("afterbegin",t)};else{var t=document.querySelector("#sitecorAuthorToolbox");t&&t.remove()}}))}chrome.storage.sync.get(["feature_charscount"],(function(e){if(null==e.feature_charscount&&(e.feature_charscount=!0),e.feature_charscount){var t,a,r=document.querySelectorAll("input, textarea"),o=0;for(var n of r)"scContentControl"!=n.className&&"scContentControlMemo"!=n.className||(n.setAttribute("style","padding-right: 70px !important"),n.parentElement.setAttribute("style","position:relative !important"),o=n.value.length,a=o>1?o+" chars":o+" char",t='<div id="chars_'+n.id+'" style="position: absolute; bottom: 1px; right: 1px; padding: 6px 10px; border-radius: 4px; line-height: 20px; opacity:0.5;">'+a+"</div>",n.insertAdjacentHTML("afterend",t));document.addEventListener("keyup",(function(e){"input"!=e.target.localName&&"textarea"!=e.target.localName||(o=e.target.value.length,a=o>1?o+" chars":o+" char",document.querySelector("#chars_"+e.target.id)&&(document.querySelector("#chars_"+e.target.id).innerText=a))}),!1)}})),chrome.storage.sync.get(["feature_translatemode"],(function(a){if(null==a.feature_translatemode&&(a.feature_translatemode=!0),a.feature_translatemode){var r=document.querySelector(".scEditorPanel"),o=document.querySelectorAll(".scEditorSectionPanel .scEditorSectionPanelCell")[1],n=r.querySelectorAll("input, textarea, select");if(e=0,o&&null!=o.querySelector(".scEditorFieldMarkerInputCell > table > tbody")&&(d=!0),d){for(var s of n)if("scContentControl"==s.className||"scContentControlMemo"==s.className||"scContentControlImage"==s.className||s.className.includes("scCombobox")&&!s.className.includes("scComboboxEdit")){if(g=null,e%2==0){var i=s,c=s.getAttribute("onfocus");c=(c=(c=c.split("lang="))[1].split("&"))[0].toUpperCase()}else{var l=s,u=s.getAttribute("onfocus");u=(u=(u=u.split("lang="))[1].split("&"))[0].toUpperCase();var g=s.closest("td").parentNode.querySelectorAll("td")[1];null!=g&&(g.innerHTML='<a class="scTranslateRTL" href="javascript:copyTranslate(\''+i.id+"','"+l.id+"','RTL');\" title=\"Copy "+u+" to "+c+'"><img src="'+chrome.runtime.getURL("images/navigate_left.png")+'" style="padding: 0px 2px 0px 0px; vertical-align: bottom; width: 20px;" alt="Copy"></a>')}e++}document.querySelector("#scMessageBarTranslation")||(E='<div id="scMessageBarTranslation" class="scMessageBar scInformation"><div class="scMessageBarIcon" style="background-image:url('+iconTranslate+')"></div><div class="scMessageBarTextContainer"><div class="scMessageBarTitle">Translation Mode ('+u+" to "+c+')</div><div class="scMessageBarText">You are translating content. If you want, you can directly </b></div><ul class="scMessageBarOptions" style="margin:0px"><li class="scMessageBarOptionBullet"><span class="scMessageBarOption" onclick="javascript:copyTranslateAll();" style="cursor:pointer">Copy existing content into '+p+' version</span></li> or <li class="scMessageBarOptionBullet"><span class="scMessageBarOption" style="cursor:pointer !important;" onclick="window.open(\'https://translate.google.com/#view=home&op=translate&sl='+u.toLowerCase()+"&tl="+c.toLowerCase()+"&text=Hello Sitecore');\">Use Google Translate</span></li></ul></div></div>",t.insertAdjacentHTML("afterend",E))}}})),chrome.storage.sync.get(["feature_cetabs"],(function(e){if(null==e.feature_cetabs&&(e.feature_cetabs=!1),e.feature_cetabs){var t=document.querySelector("#scEditorTabs"),a=document.querySelector(".scEditorHeader"),r=document.querySelectorAll(".scMessageBar");r=r[r.length-1];var o=document.querySelectorAll(".scEditorSectionCaptionCollapsed, .scEditorSectionCaptionExpanded"),n=0;for(var s of(t&&t.remove(),t='<div id="scEditorTabs"><ul>',o)){var i=s.innerText,c=s.getAttribute("id"),l="",d="",u="";"scEditorSectionCaptionExpanded"==s.getAttribute("class")&&0==n?(l="scEditorTabSelected",d="table",n++):(l="",d="none"),s.setAttribute("style","display: none !important");var g=s.nextSibling;g.setAttribute("style","display: "+d+" !important"),g.querySelectorAll(".scEditorFieldMarkerBarCellRed").length>0&&(u="<span id='scCrossTabError'>üõë </span>"),t+='<li class="scEditorTabEmpty"></li>',t+='<li data-id="'+c+'" class="scEditorTab '+l+'" onclick="toggleSection(this,\''+i+"');\">"+u+i+'<span class="scEditorTabClose" onclick="hideTab(\''+i+"','"+extensionId+"')\">‚ùé</span></li>"}if(t+='<li class="scEditorTabEmpty"></li></ul></div>',r?r.insertAdjacentHTML("afterend",t):a.insertAdjacentHTML("afterend",t),0==n){var p=document.querySelector(".scEditorTab"),m=p.dataset.id,f=document.querySelector("#"+m);f.classList.remove("scEditorSectionCaptionCollapsed"),f.classList.add("scEditorSectionCaptionExpanded");var h=f.nextSibling;p.classList.add("scEditorTabSelected"),h.setAttribute("style","display: table !important")}}})),target=document.querySelector("#SearchResult"),observer=new MutationObserver((function(e){var t=document.querySelector("#SearchResult").querySelectorAll(".scSearchLink"),a=document.querySelector(".scSearchListExtra");for(var r of t){var o=r.getAttribute("title").toLowerCase();o.includes("/home/")&&(o="/"+(o=o.split("/home/"))[1]);var n=' <span class="scSearchListExtra">'+o+"</span>";o&&null==a&&(r.innerHTML+=n)}})),target&&(config={attributes:!1,childList:!0,characterData:!1,subtree:!1},observer.observe(target,config)),chrome.storage.sync.get(["feature_messagebar"],(function(e){chrome.runtime.error||1!=e.feature_messagebar||setTimeout((function(){var e=document.querySelectorAll(".scWarning");for(var a of e){var r=a.querySelector(".scMessageBarTitle").innerText,o=a.querySelector(".scMessageBarText"),n=a.querySelector(".scMessageBarIcon"),s=r.includes("' has locked this item."),i=r.includes("Elevated Unlock"),c=r.includes("is not in the final workflow step."),l=r.includes("This item is controlled by Unicorn");if(r.includes("The current item does not have a version")&&n.setAttribute("style","background-image: url("+iconTranslate+");"),c&&n.setAttribute("style","background-image: url("+iconWorkflow+");"),s){var d=(m=r.split("' "))[0].replace("'","");d+=" has",n.setAttribute("style","background-image: url("+iconLock+");")}else d="You have";i&&n.setAttribute("style","background-image: url("+iconLock+");"),l&&(a.classList.add("scOrange"),o.innerHTML=o.innerHTML.replace("<br><br>","<br>").replace("<br><b>Predicate"," <b>Predicate").replace("Changes to this item will be written to disk so they can be shared with others.<br>",""),n.setAttribute("style","background-image: url("+iconUnicorn+");"))}document.querySelector(".scRibbon").innerHTML.includes("Check this item in.")&&!i&&(E='<div id="scMessageBarUrl" class="scMessageBar scInformation"><div class="scMessageBarIcon" style="background-image:url('+iconLock+')"></div><div class="scMessageBarTextContainer"><div class="scMessageBarTitle">'+d+' locked this item.</div><div class="scMessageBarText">Nobody is able to edit it until you unlock it.</div><ul class="scMessageBarOptions"><li class="scMessageBarOptionBullet"><a href="#" onclick="javascript:return scForm.postEvent(this,event,\'item:checkin\')" class="scMessageBarOption">Unlock this item</a></li></ul></div></div>',t.insertAdjacentHTML("afterend",E))}),500)})),chrome.storage.sync.set({scItemID:f,scLanguage:S,scVersion:o},(function(){debug&&(console.info("%c [Write] Item : "+f+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;"),console.info("%c [Write] Language : "+S+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;"),console.info("%c [Write] Version : "+o+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;"))})),debug&&(console.info("%c - Sitecore Item: "+f+" ","font-size:12px; background: #7b3090; color: white; border-radius:5px; padding 3px;"),console.info("%c - Sitecore Language: "+S+" ","font-size:12px; background: #7b3090; color: white; border-radius:5px; padding 3px;"),console.info("%c - Sitecore Version: "+o+" ","font-size:12px; background: #7b3090; color: white; border-radius:5px; padding 3px;"),console.info("%c - Sitecore Hash : "+n+" ","font-size:12px; background: #7b3090; color: white; border-radius:5px; padding 3px;"))}if(debug&&console.info("%c "+window.location.href.replace("https://","").replace("http://",""),"font-size:10px; background: #32ed74; color: black; border-radius:5px; padding 3px;"),isSitecore&&!isEditMode&&!isLoginPage&&!isCss){debug&&console.info("%c ‚úèÔ∏è Sitecore detected ","font-size:14px; background: #f33d35; color: white; border-radius:5px; padding 3px;"),debug&&console.info("%c *** Loading *** ","font-size:14px; background: #ffce42; color: black; border-radius:5px; padding 3px;"),(script=document.createElement("script")).src=chrome.runtime.getURL("js/inject-min.js"),(document.head||document.documentElement).appendChild(script),script.remove(),(link=document.createElement("link")).type="text/css",link.rel="stylesheet",link.href=chrome.runtime.getURL("css/onload-min.css"),document.getElementsByTagName("head")[0].appendChild(link),navigator.platform.includes("Win")&&((link=document.createElement("link")).type="text/css",link.rel="stylesheet",link.href=chrome.runtime.getURL("css/windows-min.css"),document.getElementsByTagName("head")[0].appendChild(link));var extensionId=chrome.runtime.getURL("something");if(extensionId=(extensionId=(extensionId=extensionId.split("chrome-extension://"))[1].split("/something"))[0],
document.querySelector("body").insertAdjacentHTML("beforeend",'<input type="hidden" class="extensionId" value="'+extensionId+'" />'),window.Notification?"granted"===Notification.permission||Notification.requestPermission().then((function(e){"granted"===e||console.warn("User blocked notifications.")})).catch((function(e){console.warn(e)})):console.info("Browser does not support notifications."),(isContentEditor||isLaunchpad)&&(debug&&console.info("%c **** Content Editor / Launchpage **** ","font-size:14px; background: #f16100; color: black; border-radius:5px; padding 3px;"),hasRedirection||hasRedirectionOther||isLaunchpad||chrome.storage.sync.get(["scItemID","scLanguage","scVersion","feature_reloadnode"],(function(e){if(chrome.runtime.error||null==e.scItemID)sitecoreAuthorToolbox();else if(null==e.feature_reloadnode&&(e.feature_reloadnode=!0),""!=scUrlHash&&(e.scItemID!=scUrlHash&&(e.scVersion=1),e.scItemID=scUrlHash),e.scItemID&&1==e.feature_reloadnode){debug&&console.info("%c [Read] Item : "+e.scItemID+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;"),debug&&console.info("%c [Read] Language : "+e.scLanguage+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;"),debug&&console.info("%c [Read] Version : "+e.scVersion+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;"),debug&&console.info("%c *** Redirection *** ","font-size:14px; background: #ffce42; color: black; border-radius:5px; padding 3px;");var t='scForm.invoke("item:load(id='+e.scItemID+",language="+e.scLanguage+",version="+e.scVersion+')");';(script=document.createElement("script")).textContent=t,(document.head||document.documentElement).appendChild(script),script.remove()}else sitecoreAuthorToolbox()})),chrome.storage.sync.get(["feature_favorites"],(function(e){if(null==e.feature_favorites&&(e.feature_favorites=!0),e.feature_favorites&&!isPublishWindow&&scContentTree){var t=document.querySelector("#sitecorAuthorToolboxFav");t&&t.remove();var a='<iframe id="sitecorAuthorToolboxFav" class="sitecorAuthorToolboxFav" src="'+("../default.aspx?xmlcontrol=Gallery.Favorites&id="+sitecoreItemID+"&la=en&vs=1")+'" style="width:100%; height:150px; margin-top: 0px; resize: vertical;"></iframe>';scContentTree.insertAdjacentHTML("afterend",a)}})),isLaunchpad||chrome.storage.sync.get(["hideSnackbar"],(function(e){chrome.runtime.error||1==e.hideSnackbar||showSnackbar(1)})),chrome.storage.sync.get(["feature_workbox"],(function(e){chrome.runtime.error||1!=e.feature_workbox||checkWorkbox()}))),chrome.storage.sync.get(["feature_darkmode"],(function(e){if(null==e.feature_darkmode&&(e.feature_darkmode=!1),e.feature_darkmode&&!isExperienceEditor&&!isAdminCache&&!isSecurityWindow&&!isContentHome&&!isLoginPage&&!isEditMode&&!isUserManager&&!isRules&&!isAdmin){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/default-min.css"),document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("link")).type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/ribbon-min.css"),document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("link")).type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/contentmanager-min.css"),document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("link")).type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/dialogs-min.css"),document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("link")).type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/gallery-min.css"),document.getElementsByTagName("head")[0].appendChild(t),(t=document.createElement("link")).type="text/css",t.rel="stylesheet",t.href=chrome.runtime.getURL("css/dark/speak-min.css"),document.getElementsByTagName("head")[0].appendChild(t)}})),isDesktop&&!isGalleryFavorites?(debug&&console.info("%c **** Desktop Shell **** ","font-size:14px; background: #f16100; color: black; border-radius:5px; padding 3px;"),chrome.storage.sync.get(["feature_launchpad"],(function(e){if(null==e.feature_launchpad&&(e.feature_launchpad=!0),e.feature_launchpad){var t='<a href="#" class="scStartMenuLeftOption" title="" onclick="window.location.href=\''+launchpadPage+"?launchpad=true&url="+windowLocationHref+'\'"><img src="'+launchpadIcon+'" class="scStartMenuLeftOptionIcon" alt="" border="0"><div class="scStartMenuLeftOptionDescription"><div class="scStartMenuLeftOptionDisplayName">'+launchpadGroupTitle+'</div><div class="scStartMenuLeftOptionTooltip">Options</div></div></a>',a=document.querySelectorAll(".scStartMenuLeftOption");for(let e of a)"Install and maintain apps."==e.getAttribute("title")&&e.insertAdjacentHTML("afterend",t)}}))):isLaunchpad?(debug&&console.info("%c **** Launchpad **** ","font-size:14px; background: #f16100; color: black; border-radius:5px; padding 3px;"),chrome.storage.sync.get(["feature_launchpad"],(function(e){if(null==e.feature_launchpad&&(e.feature_launchpad=!0),e.feature_launchpad){var t=document.querySelectorAll(".last"),a='<div class="sc-launchpad-group"><header class="sc-launchpad-group-title">Sitecore Author Toolbox</header><div class="sc-launchpad-group-row"><a href="#" onclick="window.location.href=\''+launchpadPage+"?launchpad=true&url="+windowLocationHref+'\'" class="sc-launchpad-item" title="Options"><span class="icon"><img src="'+launchpadIcon+'" width="48" height="48" alt="Options"></span><span class="sc-launchpad-text">Options</span></a></div></div>';t[0].insertAdjacentHTML("afterend",a)}}))):isAdminCache&&debug&&console.info("%c **** Admin Cache **** ","font-size:14px; background: #f16100; color: black; border-radius:5px; padding 3px;"),isGalleryFavorites)debug&&console.info("%c **** Favorites **** ","font-size:14px; background: #f16100; color: black; border-radius:5px; padding 3px;");else if(isModalDialogs)debug&&console.info("%c **** Jquery Modal **** ","font-size:14px; background: #f16100; color: black; border-radius:5px; padding 3px;");else if(isSearch)debug&&console.info("%c **** Internal Search **** ","font-size:14px; background: #f16100; color: black; border-radius:5px; padding 3px;"),target=document.querySelector("#results"),observer=new MutationObserver((function(e){var t=document.querySelector("#results").querySelectorAll(".BlogPostArea");for(var a of t){var r=a.querySelector(".BlogPostFooter"),o=a.querySelector(".BlogPostViews > a > img").getAttribute("title");(o=(o=o.split(" - "))[1].toLowerCase()).includes("/home/")&&(o="/"+(o=o.split("/home/"))[1]);var n='<div class="BlogPostExtra BlogPostContent" style="padding: 5px 0 0px 78px; color: #4d82b8"><strong>Sitecore path:</strong> '+o+" <strong>Languages available:</strong> "+a.querySelector(".BlogPostHeader > span").getAttribute("title")+"</div>";o&&r.insertAdjacentHTML("afterend",n)}})),target&&(config={attributes:!1,childList:!0,characterData:!1,subtree:!1},observer.observe(target,config));else if(isFieldEditor){debug&&console.info("%c **** Field editor Search **** ","font-size:14px; background: #f16100; color: black; border-radius:5px; padding 3px;"),chrome.storage.sync.get(["feature_charscount"],(function(e){if(null==e.feature_charscount&&(e.feature_charscount=!0),e.feature_charscount){var t,a,r=document.querySelectorAll("input, textarea"),o=0;for(var n of r)"scContentControl"!=n.className&&"scContentControlMemo"!=n.className||(n.setAttribute("style","padding-right: 70px !important"),n.parentElement.setAttribute("style","position:relative !important"),o=n.value.length,a=o>1?o+" chars":o+" char",t='<div id="chars_'+n.id+'" style="position: absolute; bottom: 1px; right: 1px; padding: 6px 10px; border-radius: 4px; line-height: 20px; opacity:0.5;">'+a+"</div>",n.insertAdjacentHTML("afterend",t));document.addEventListener("keyup",(function(e){"input"!=e.target.localName&&"textarea"!=e.target.localName||(o=e.target.value.length,a=o>1?o+" chars":o+" char",debug&&console.log("chars_"+e.target.id+" -> "+a),document.querySelector("#chars_"+e.target.id)&&(document.querySelector("#chars_"+e.target.id).innerText=a))}),!1)}}));var scBucketListSelectedBox=document.querySelectorAll(".scBucketListSelectedBox, .scContentControlMultilistBox"),Section_Data=document.querySelector("#Section_Data");(scBucketListSelectedBox=scBucketListSelectedBox[1]?scBucketListSelectedBox[1]:scBucketListSelectedBox[0])&&scBucketListSelectedBox.addEventListener("change",(function(){var e=scBucketListSelectedBox.value,t=scBucketListSelectedBox[scBucketListSelectedBox.selectedIndex].text,a=chrome.runtime.getURL("images/rocket.png"),r='<a class="scMessageBarOption" href="'+window.location.origin+"/sitecore/shell/Applications/Content%20Editor.aspx#"+e+'" target="_blank"><u>Click here ‚ßâ</u></a> ',o='<a class="scMessageBarOption" href="'+window.location.origin+"/?sc_mode=edit&sc_itemid="+e+'" target="_blank"><u>Click here ‚ßâ</u></a> ',n='<div id="Warnings" class="scMessageBar scWarning"><div class="scMessageBarIcon" style="background-image:url('+a+')"></div><div class="scMessageBarTextContainer"><div class="scMessageBarTitle">'+t+'</div><span id="Information" class="scMessageBarText"><span class="scMessageBarOptionBullet">'+r+'</span> to edit this item in <b>Content Editor</b>.</span><span id="Information" class="scMessageBarText"><br /><span class="scMessageBarOptionBulletXP">'+o+"</span> to edit this page in <b>Experience Editor</b>.</span></div></div>";document.querySelector(".scMessageBar")?(document.querySelector(".scMessageBarTitle").innerHTML=t,document.querySelector(".scMessageBarOptionBullet").innerHTML=r,document.querySelector(".scMessageBarOptionBulletXP").innerHTML=o):Section_Data.insertAdjacentHTML("beforebegin",n)})),chrome.storage.sync.get(["feature_errors"],(function(e){null==e.feature_errors&&(e.feature_errors=!0);var t=0,a=document.getElementsByClassName("scValidationMarkerIcon"),r=document.querySelector("#MainPanel"),o=chrome.runtime.getURL("images/error.png");if(e.feature_errors){var n='<div id="scMessageBarError" class="scMessageBar scError"><div class="scMessageBarIcon" style="background-image:url('+o+')"></div><div class="scMessageBarTextContainer"><ul class="scMessageBarOptions" style="margin:0px">';for(let e of a)"/sitecore/shell/themes/standard/images/bullet_square_yellow.png"!=e.getAttribute("src")&&(n+='<li class="scMessageBarOptionBullet" onclick="'+e.getAttribute("onclick")+'" style="cursor:pointer;">'+e.getAttribute("title")+"</li>",t++);n+="</ul></div></div>",t>0&&r.insertAdjacentHTML("beforebegin",n);var s=document.querySelector(".scValidatorPanel"),i=new MutationObserver((function(e){t=0;var n='<div id="scMessageBarError" class="scMessageBar scError"><div class="scMessageBarIcon" style="background-image:url('+o+')"></div><div class="scMessageBarTextContainer"><ul class="scMessageBarOptions" style="margin:0px">';for(let e of a)"/sitecore/shell/themes/standard/images/bullet_square_yellow.png"!=e.getAttribute("src")&&(console.log(e),n+='<li class="scMessageBarOptionBullet" onclick="'+e.getAttribute("onclick")+'" style="cursor:pointer;">'+e.getAttribute("title")+"</li>",t++);if(n+="</ul></div></div>",t>0)r.insertAdjacentHTML("beforebegin",n);else{var s=document.getElementById("scMessageBarError");s&&s.parentNode.removeChild(s)}debug&&console.log("!! Change !!")}));if(s){i.observe(s,{attributes:!0,childList:!0,characterData:!0})}}}))}else isRichTextEditor||isHtmlEditor?(debug&&console.info("%c **** Rich text editor **** ","font-size:14px; background: #f16100; color: black; border-radius:5px; padding 3px;"),chrome.storage.sync.get(["feature_rtecolor","feature_darkmode"],(function(e){if(null==e.feature_rtecolor&&(e.feature_rtecolor=!0),null==e.feature_darkmode&&(e.feature_darkmode=!1),e.feature_rtecolor){var t,a="default";if(isRichTextEditor?t=document.querySelector("#Editor_contentIframe"):isHtmlEditor&&(t=document.querySelector("#ctl00_ctl00_ctl05_Html")),t){if(isRichTextEditor){document.querySelector("#Editor_contentIframe").contentWindow.document.body,document.querySelector("#EditorContentHiddenTextarea");var r=document.querySelector(".reTextArea")}(link=document.createElement("link")).type="text/css",link.rel="stylesheet",link.href=chrome.runtime.getURL("css/codemirror.css"),document.getElementsByTagName("head")[0].appendChild(link),e.feature_darkmode&&(a="ayu-dark",(link=document.createElement("link")).type="text/css",link.rel="stylesheet",link.href=chrome.runtime.getURL("css/dark/ayu-dark.css"),document.getElementsByTagName("head")[0].appendChild(link)),isRichTextEditor?(r.insertAdjacentHTML("afterend",'<input type="hidden" class="scDarkMode" value="'+a+'" />'),r.insertAdjacentHTML("afterend",'<input type="hidden" class="scEditor" value="richTextEditor" />')):isHtmlEditor&&(t.insertAdjacentHTML("afterend",'<input type="hidden" class="scDarkMode" value="'+a+'" />'),t.insertAdjacentHTML("afterend",'<input type="hidden" class="scEditor" value="htmlEditor" />')),(script=document.createElement("script")).src=chrome.runtime.getURL("js/bundle.js"),(document.head||document.documentElement).appendChild(script),script.remove()}}}))):isGalleryLanguage?(debug&&console.info("%c **** Languages menu **** ","font-size:14px; background: #f16100; color: black; border-radius:5px; padding 3px;"),chrome.storage.sync.get(["feature_flags"],(function(e){if(null==e.feature_flags&&(e.feature_flags=!0),e.feature_flags){var t,a,r,o,n=document.querySelector("#Languages").querySelectorAll(".scMenuPanelItem,.scMenuPanelItemSelected"),s=0;for(let e of n){s=0,t=e.getElementsByTagName("td");for(let e of t){if(0==s)r=e.getElementsByTagName("img");else{if(a=(a=e.getElementsByTagName("b"))[0].innerHTML,"0"!=e.getElementsByTagName("div")[2].innerHTML.split(" ")[0]&&e.getElementsByTagName("div")[2].setAttribute("style","background-color: yellow; display: initial; padding: 0px 3px; color: #000000 !important"),a.includes("(region)"))for(o in a=a.split(" (region"),jsonData)jsonData.hasOwnProperty(o)&&a[0].toUpperCase()==jsonData[o].language.toUpperCase()&&(a=jsonData[o].flag);else a=cleanCountryName(a);a=a.toLowerCase(),r[0].onerror=function(){this.src=chrome.runtime.getURL("images/Flags/32x32/flag_generic.png")},r[0].src=chrome.runtime.getURL("images/Flags/32x32/flag_"+a+".png")}s++}0}}}))):isPublishWindow&&(debug&&console.info("%c **** Publish / Rebuild **** ","font-size:14px; background: #f16100; color: black; border-radius:5px; padding 3px;"),chrome.storage.sync.get(["feature_flags"],(function(e){if(null==e.feature_flags&&(e.feature_flags=!0),e.feature_flags){var t,a,r,o=document.querySelector("#Languages").getElementsByTagName("label");for(let e of o){for(a in t=cleanCountryName(e.innerText),jsonData)jsonData.hasOwnProperty(a)&&t==jsonData[a].language.toUpperCase()&&(t=jsonData[a].flag);r=t.toLowerCase(),r=chrome.runtime.getURL("images/Flags/16x16/flag_"+r+".png"),e.insertAdjacentHTML("beforebegin",' <img id="scFlag" src="'+r+'" style="display: inline; vertical-align: middle; padding-right: 2px;" onerror="this.onerror=null;this.src=\'-/icon/Flags/16x16/flag_generic.png\';"/>')}}})));chrome.storage.sync.get(["feature_autoexpand"],(function(e){null==e.feature_autoexpand&&(e.feature_autoexpand=!0),e.feature_autoexpand&&(document.addEventListener("click",(function(e){if(!e.target.matches(".scContentTreeNodeGlyph"))return;let t=e.target.id;setTimeout((function(){if(document&&t){let e=document.querySelector("#"+t).nextSibling.nextSibling.nextSibling;if(e){let t=e.querySelectorAll(".scContentTreeNode");1==t.length&&t[0].querySelector(".scContentTreeNodeGlyph").click()}}}),200)}),!1),document.addEventListener("mousedown",(function(e){if(!e.target.matches(".glyph"))return;let t=e.target.id,a=e.target.src.includes("collapsed");setTimeout((function(){if(document&&t&&a){var e=document.querySelector("#"+t).closest("ul").nextSibling;if(e)e.querySelector(".glyph").click()}}),200)}),!1))})),target=document.querySelector("#LastPage"),observer=new MutationObserver((function(e){chrome.storage.sync.get(["feature_notification"],(function(e){if(null==e.feature_notification&&(e.feature_notification=!0),e.feature_notification){var t=(target=document.querySelector("#LastPage")).querySelector(".sc-text-largevalue").innerHTML,a=target.querySelector(".scFieldLabel").innerHTML;"Result:"==a&&(a="Finished "+document.querySelector("#ResultText").value.split("Finished")[1]),sendNotification(t,a),checkUrlStatus(parent.parent.document.querySelector("body"))}})),debug&&console.info("%c *** Publish/Rebuild Done *** ","font-size:14px; background: #ffce42; color: black; border-radius:5px; padding 3px;")})),target&&observer.observe(target,{attributes:!0}),target=document.querySelector("#scLanguage");var observer=new MutationObserver((function(e){debug&&console.info("%c *** Update UI *** ","font-size:14px; background: #ffce42; color: black; border-radius:5px; padding 3px;");var t=document.querySelector(".scEditorHeaderQuickInfoInput");if(t){var a=t.getAttribute("value"),r=(document.querySelector("#scLanguage").getAttribute("value").toLowerCase(),document.querySelectorAll(".scEditorQuickInfo")),o=(r[r.length-1],r.length),n=document.getElementsByClassName("scEditorHeaderTitle"),s=document.querySelectorAll(".scEditorHeaderQuickInfoInput"),i=s[s.length-2].getAttribute("value");if(hasRedirection||hasRedirectionOther||(window.location.hash=a),debug&&console.info("%c - Tabs opened: "+o+" ","font-size:12px; background: #7b3090; color: white; border-radius:5px; padding 3px;"),o>1&&!document.getElementById("showInContentTree"+o)){var c=window.location.href,l=(c=c.split("#"))[0]+"&reload#"+i;n[o-1].insertAdjacentHTML("afterend",'[<a id="showInContentTree'+o+'" href="" onclick="javascript:window.location.href=\''+l+"'; return false;\" />Show in content tree</a>]")}}e.forEach((function(e){"attributes"==e.type&&sitecoreAuthorToolbox()}))}));target&&observer.observe(target,{attributes:!0})}if(isEditMode&&!isLoginPage||isPreviewMode&&!isLoginPage){if(debug&&console.info("%c üé® Experience Editor detected ","font-size:14px; background: #f16100; color: black; border-radius:5px; padding 3px;"),(link=document.createElement("link")).type="text/css",link.rel="stylesheet",link.href=chrome.runtime.getURL("css/onload-min.css"),document.getElementsByTagName("head")[0].appendChild(link),(link=document.createElement("link")).type="text/css",link.rel="stylesheet",link.href=chrome.runtime.getURL("css/reset-min.css"),document.getElementsByTagName("head")[0].appendChild(link),(link=document.createElement("link")).type="text/css",link.rel="stylesheet",link.href=chrome.runtime.getURL("css/tooltip-min.css"),document.getElementsByTagName("head")[0].appendChild(link),(script=document.createElement("script")).src=chrome.runtime.getURL("js/inject-min.js"),(document.head||document.documentElement).appendChild(script),script.remove(),isGalleryLanguageExpEd&&(debug&&console.info("====================> LANGUAGES IN EXPERIENCE EDITOR <===================="),chrome.storage.sync.get(["feature_flags"],(function(e){if(null==e.feature_flags&&(e.feature_flags=!0),e.feature_flags){var t,a,r,o,n=document.querySelector(".sc-gallery-content").querySelectorAll(".sc-gallery-option-content,.sc-gallery-option-content-active");for(let e of n){for(o in t=e.closest(".sc-gallery-option-content,.sc-gallery-option-content-active"),a=e.querySelector(".sc-gallery-option-content-header > span").innerText,"0"!=(r=e.querySelector(".sc-gallery-option-content-description > span")).innerHTML.split(" ")[0]&&r.setAttribute("style","background-color: yellow; display: initial; padding: 0px 3px; color: #000000 !important"),a=cleanCountryName(a),jsonData)jsonData.hasOwnProperty(o)&&a==jsonData[o].language.toUpperCase()&&(a=jsonData[o].flag);t.setAttribute("style","padding-left:48px; background-image: url("+chrome.runtime.getURL("images/Flags/32x32/flag_"+a+".png")+"); background-repeat: no-repeat; background-position: 5px;")}}}))),isRibbon){debug&&console.info("====================> RIBBON <====================");var tdlanguage,temp,key,scRibbonFlagIcons=document.querySelectorAll(".flag_generic_24");for(var flag of scRibbonFlagIcons){for(key in tdlanguage=cleanCountryName(tdlanguage=flag.nextSibling.innerText),jsonData)jsonData.hasOwnProperty(key)&&tdlanguage==jsonData[key].language.toUpperCase()&&(tdlanguage=jsonData[key].flag);flag.setAttribute("style","background-image: url("+chrome.runtime.getURL("images/Flags/24x24/flag_"+tdlanguage+".png")+"); background-repeat: no-repeat; background-position: top left;")}var dataItemId=document.querySelector("[data-sc-itemid]");if(dataItemId){var sitecoreItemID=decodeURI(dataItemId.getAttribute("data-sc-itemid"));chrome.storage.sync.set({scItemID:sitecoreItemID},(function(){debug&&console.info("%c [Storage Set] Item : "+sitecoreItemID+" ","font-size:12px; background: #cdc4ba; color: black; border-radius:5px; padding 3px;")}))}}if(target=document.querySelector(".scChromeControls"),observer=new MutationObserver((function(e){var t=document.querySelectorAll(".scChromeToolbar");for(var a of t){a.setAttribute("style","margin-left:50px");var r=a.querySelectorAll(".scChromeCommand");a.querySelector(".scChromeText"),a.querySelector(".scChromeCommandText");for(var o of r){var n=o.getAttribute("title");o.setAttribute("style","z-index:auto"),null!=n&&(o.setAttribute("data-tooltip",n),o.classList.add("t-bottom"),o.classList.add("t-sm"),o.removeAttribute("title"))}}})),target){var config={attributes:!0,childList:!0,characterData:!0};observer.observe(target,config)}chrome.storage.sync.get(["feature_darkmode","feature_toggleribbon"],(function(e){var t=document.querySelector(".pagemode-edit");t||(t=document.querySelector(".on-page-editor")),t||(t=document.querySelector(".experience-editor"));windowLocationHref.includes("?");var a=windowLocationHref.includes("sc_mode=edit"),r=windowLocationHref.includes("sc_mode=preview");document.querySelector("#scCrossPiece"),document.querySelector("#scWebEditRibbon"),document.querySelector(".sc-messageBar");let o;if(null==e.feature_darkmode&&(e.feature_darkmode=!1),null==e.feature_toggleribbon&&(e.feature_toggleribbon=!0),e.feature_darkmode&&isRibbon||e.feature_darkmode&&isDialog||e.feature_darkmode&&isInsertPage){var n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=chrome.runtime.getURL("css/dark/experience-min.css"),document.getElementsByTagName("head")[0].appendChild(n)}e.feature_darkmode&&(o="dark");var s,i=document.body,c=new MutationObserver((function(e){for(var t of e)for(var a of t.addedNodes)if("scCrossPiece"==a.id){var r='<div class="scExpTab '+o+'"><span class="tabHandle"></span><span class="tabText" onclick="toggleRibbon()">‚ñ≤ Hide<span></div>';a.insertAdjacentHTML("afterend",r),c.disconnect(),startDrag()}}));if(e.feature_toggleribbon&&i){c.observe(i,{attributes:!1,childList:!0,characterData:!1})}if(s=a?windowLocationHref.replace("sc_mode=edit","sc_mode=normal"):r?windowLocationHref.replace("sc_mode=preview","sc_mode=normal"):windowLocationHref+"?sc_mode=normal",e.feature_toggleribbon&&!isRibbon){var l='<div class="scNormalModeTab '+o+'"><span class="t-right t-sm" data-tooltip="Open in Normal Mode"><a href="'+s+'"><img src="'+iconEE+'"/></a></span></div>';t.insertAdjacentHTML("afterend",l)}e.feature_toggleribbon&&!isRibbon&&(l='<div class="scContentEditorTab '+o+'"><span class="t-right t-sm" data-tooltip="Open in Content Editor"><a href="'+window.location.origin+'/sitecore/shell/Applications/Content%20Editor.aspx?sc_bw=1"><img src="'+iconCE+'"/></a></span></div>',t.insertAdjacentHTML("afterend",l))}))}