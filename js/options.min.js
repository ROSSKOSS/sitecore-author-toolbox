function animateHeader(scroll_pos){scroll_pos>=90?document.querySelector("#banner").classList.add("animate"):document.querySelector("#banner").classList.remove("animate")}const deleteSite=site=>{document.querySelector("#"+site).remove()},addSite=(domain,path,cd)=>{let countSites=document.querySelectorAll(".site").length+1,html='\n  <div class="site" id="site_'+countSites+`">\n  <div class="cm_url">\n    <input name="key" type="url" placeholder="Sitecore path to /home" value="${path}">\n  </div>\n  <div id="arrow">&nbsp;</div>\n  <div class="cd_url">\n    <input name="value" type="url" placeholder="CD URL" pattern="https?://.*" value="${cd}">\n  </div> \n  <div class="delete deleteSite_`+countSites+'" >&nbsp;</div>\n  </div>';document.querySelector("#"+domain+" > .addSite").insertAdjacentHTML("beforebegin",html),document.querySelector(".deleteSite_"+countSites).addEventListener("click",deleteSite.bind("","site_"+countSites,"",""))},addDomain=text=>{let isExisting=!1,url=prompt("Please enter a domain URL",text);if(null!==url)try{let newUrl=new URL(url),countDomains=document.querySelectorAll(".domain").length+1;if(document.querySelectorAll(".domain").forEach(elem=>{newUrl.origin==elem.dataset.domain&&(alert("This domain already exist."),isExisting=!0)}),0==isExisting){let html='\n        <div class="domain" id="domain_'+countDomains+'" data-domain="'+newUrl.origin+'">\n          <h3>'+countDomains+" - "+newUrl.origin+'</h3>\n          <div class="addSite addSite_'+countDomains+'">Add sites</div>\n        </div>';document.querySelector(".addDomain").insertAdjacentHTML("beforebegin",html),document.querySelector(".addSite_"+countDomains).addEventListener("click",addSite.bind("","domain_"+countDomains,"","")),addSite("domain_"+countDomains,"","")}}catch(error){alert("Your domain is not a valid URL, please try again"),addDomain(url)}},toggleFeature=(featureStorage,featureId,defautlState=!0)=>{console.log("Storage "+featureId+" -> ",featureStorage),null!=featureStorage?featureStorage&&(document.querySelector(featureId).checked=!0):document.querySelector(featureId).checked=defautlState};document.body.onload=function(){let url=new URL(window.location.href),fromLaunchpad=url.searchParams.get("launchpad"),backUrl=url.searchParams.get("url"),configureDomains=url.searchParams.get("configure_domains"),ticking=!1;document.querySelector("#scVersion").innerHTML=chrome.runtime.getManifest().version,fromLaunchpad&&(document.querySelector("#set").innerHTML="Save your preferences",document.querySelector("#scHeader").style.display="inherit",document.querySelector("#scBack").href=backUrl,document.querySelector("#banner").style.top="50px",document.querySelector("#bannerTitle").style.opacity="1",document.querySelector("#intro").style.marginTop="50px"),configureDomains&&document.querySelector("#settings").click(),fromLaunchpad||window.addEventListener("scroll",(function(){ticking||(window.requestAnimationFrame((function(){animateHeader(window.scrollY),ticking=!1})),ticking=!0)})),chrome.storage.sync.get(storage=>{toggleFeature(storage.feature_urls,"#feature_urls",!0),toggleFeature(storage.feature_urlstatus,"#feature_urlstatus",!0),toggleFeature(storage.feature_flags,"#feature_flags",!0),toggleFeature(storage.feature_errors,"#feature_errors",!0),toggleFeature(storage.feature_notification,"#feature_notification",!0),toggleFeature(storage.feature_darkmode,"#feature_darkmode",!1),toggleFeature(storage.feature_darkmode_auto,"#feature_darkmode_auto",!0),toggleFeature(storage.feature_favorites,"#feature_favorites",!1),toggleFeature(storage.feature_reloadnode,"#feature_reloadnode",!0),toggleFeature(storage.feature_launchpad,"#feature_launchpad",!0),toggleFeature(storage.feature_launchpad_tiles,"#feature_launchpad_tiles",!1),toggleFeature(storage.feature_rtl,"#feature_rtl",!0),toggleFeature(storage.feature_charscount,"#feature_charscount",!0),toggleFeature(storage.feature_autoexpand,"#feature_autoexpand",!0),toggleFeature(storage.feature_translatemode,"#feature_translatemode",!1),toggleFeature(storage.feature_contenteditor,"#feature_contenteditor",!0),toggleFeature(storage.feature_experienceeditor,"#feature_experienceeditor",!0),toggleFeature(storage.feature_cetabs,"#feature_cetabs",!1),toggleFeature(storage.feature_rtecolor,"#feature_rtecolor",!0),toggleFeature(storage.feature_messagebar,"#feature_messagebar",!1),toggleFeature(storage.feature_workbox,"#feature_workbox",!0),toggleFeature(storage.feature_contextmenu,"#feature_contextmenu",!0),toggleFeature(storage.feature_gravatarimage,"#feature_gravatarimage",!0),toggleFeature(storage.feature_helplink,"#feature_helplink",!0),toggleFeature(storage.feature_instantsearch,"#feature_instantsearch",!0),toggleFeature(storage.feature_experimentalui,"#feature_experimentalui",!1),toggleFeature(storage.feature_contrast_icons,"#feature_contrast_icons",!1)})},document.querySelector("#feature_experimentalui").onclick=function(){1==document.querySelector("#feature_experimentalui").checked&&(document.querySelector("#feature_cetabs").checked=!0)},document.querySelector("#feature_darkmode").onclick=function(){0==document.querySelector("#feature_darkmode").checked?(document.querySelector("#feature_darkmode_auto").disabled=!0,document.querySelector("#feature_darkmode_auto").checked=!1):(document.querySelector("#feature_darkmode_auto").disabled=!1,document.querySelector("#feature_darkmode_auto").checked=!1)},document.querySelector("#settings").onclick=function(){document.querySelector("#main").setAttribute("style","display:none"),document.querySelector("#domains").setAttribute("style","display:block"),document.querySelector("#save").setAttribute("style","display:none")},document.querySelector("#back").onclick=function(){event.preventDefault();var url=new URL(window.location.href),configureDomains=url.searchParams.get("configure_domains"),backUrl=url.searchParams.get("url");"true"==configureDomains?(window.open(backUrl+"&sc_bw=1"),window.close()):(document.querySelector("#main").setAttribute("style","display:block"),document.querySelector("#domains").setAttribute("style","display:none"),document.querySelector("#save").setAttribute("style","display:block"))},chrome.storage.sync.get(["site_manager"],(function(result){if(document.querySelector("#sitesList").insertAdjacentHTML("afterend",'<div class="addDomain">Add a new domain</div>'),document.querySelector(".addDomain").addEventListener("click",addDomain.bind("","")),null!=result.site_manager)for(let[path,cd]of Object.entries(result.site_manager))addSite(path,cd)})),document.querySelector("#set_domains").onclick=function(event){event.preventDefault();var formData={};let sites=document.querySelectorAll("form#domains #sitesList input");for(var i=0;i<sites.length;i++)i%2==0&&sites[i].value&&(formData[sites[i].value]=sites[i+1].value);console.log(formData)},document.querySelector("#set").onclick=function(event){event.preventDefault();let featuresEnabled={feature_urls:document.querySelector("#feature_urls").checked,feature_flags:document.querySelector("#feature_flags").checked,feature_errors:document.querySelector("#feature_errors").checked,feature_notification:document.querySelector("#feature_notification").checked,feature_darkmode:document.querySelector("#feature_darkmode").checked,feature_darkmode_auto:document.querySelector("#feature_darkmode_auto").checked,feature_favorites:document.querySelector("#feature_favorites").checked,feature_reloadnode:document.querySelector("#feature_reloadnode").checked,feature_launchpad:document.querySelector("#feature_launchpad").checked,feature_launchpad_tiles:document.querySelector("#feature_launchpad_tiles").checked,feature_charscount:document.querySelector("#feature_charscount").checked,feature_autoexpand:document.querySelector("#feature_autoexpand").checked,feature_translatemode:document.querySelector("#feature_translatemode").checked,feature_contenteditor:document.querySelector("#feature_contenteditor").checked,feature_experienceeditor:document.querySelector("#feature_experienceeditor").checked,feature_cetabs:document.querySelector("#feature_cetabs").checked,feature_rtecolor:document.querySelector("#feature_rtecolor").checked,feature_messagebar:document.querySelector("#feature_messagebar").checked,feature_workbox:document.querySelector("#feature_workbox").checked,feature_urlstatus:document.querySelector("#feature_urlstatus").checked,feature_contextmenu:document.querySelector("#feature_contextmenu").checked,feature_gravatarimage:document.querySelector("#feature_gravatarimage").checked,feature_helplink:document.querySelector("#feature_helplink").checked,feature_instantsearch:document.querySelector("#feature_instantsearch").checked,feature_experimentalui:document.querySelector("#feature_experimentalui").checked,feature_contrast_icons:document.querySelector("#feature_contrast_icons").checked};chrome.storage.sync.set(featuresEnabled,(function(){console.log(featuresEnabled)}));let url,fromLaunchpad=new URL(window.location.href).searchParams.get("launchpad"),buttonLabel="Save your preferences";fromLaunchpad||(chrome.tabs.query({active:!0,currentWindow:!0},(function(arrayOfTabs){let code="window.location.reload();";chrome.tabs.executeScript(arrayOfTabs[0].id,{code:code})})),buttonLabel="Save and reload Sitecore"),document.querySelector("#set").innerHTML="Saving...",setTimeout((function(){document.querySelector("#set").innerHTML="OK!"}),1e3),setTimeout((function(){document.querySelector("#set").innerHTML=buttonLabel}),1500)};