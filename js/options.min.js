const preferesColorScheme=()=>{let color="light";return color=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",color};chrome.storage.sync.get(["feature_darkmode","feature_darkmode_auto"],(function(result){if(result.feature_darkmode&&result.feature_darkmode_auto){const scheme=window.matchMedia("(prefers-color-scheme: dark)");scheme.addEventListener("change",()=>{window.location.reload()})}})),document.body.onload=function(){var manifestData=chrome.runtime.getManifest();document.getElementById("scVersion").innerHTML=manifestData.version;var url=new URL(window.location.href),fromLaunchpad=url.searchParams.get("launchpad"),backUrl=url.searchParams.get("url"),configureDomains=url.searchParams.get("configure_domains");fromLaunchpad&&(document.getElementById("set").innerHTML="Save your preferences",document.getElementById("scHeader").style.display="inherit",document.getElementById("scBack").href=backUrl,document.getElementById("banner").style.top="50px",document.getElementById("bannerTitle").style.opacity="1",document.getElementById("intro").style.marginTop="50px",document.getElementById("video").style.display="inherit"),"true"==configureDomains&&(document.querySelector("#settings").click(),document.querySelector("#video").setAttribute("style","display:none")),chrome.storage.sync.get(["domain_manager"],(function(result){var domains;if(!chrome.runtime.error){null!=result.domain_manager&&(domains=Object.keys(result.domain_manager));for(var html="",domain1,domain2="",i=0;i<6;i++)1==Array.isArray(domains)&&null!=domains[i]?(domain1=domains[i],domain2=result.domain_manager[domain1]):(domain1="",domain2=""),html+='\x3c!-- loop start --\x3e\n              <div class="cm_url">\n                \x3c!-- <label for="cm['+i+']">CM<b>*</b>:</label> --\x3e\n                <input name="cm['+i+']" type="url" placeholder="CM URL" pattern="https?://.*" value="'+domain1+'">\n              </div>\n\n              <div id="arrow">&nbsp;</div>\n\n              <div class="cd_url">\n                \x3c!-- <label for="cd['+i+']">Live or CD<b>*</b>:</label> --\x3e\n                <input name="cd['+i+']" type="url" placeholder="CD or Live URL" pattern="https?://.*" value="'+domain2+'">\n              </div>\n            \n              <div id="clear"></div>\n              \x3c!-- loop end --\x3e';document.querySelector("#load").innerHTML=html}})),chrome.storage.sync.get(["feature_urls"],(function(result){chrome.runtime.error||null==result.feature_urls?document.getElementById("feature_urls").checked=!0:result.feature_urls&&(document.getElementById("feature_urls").checked=!0)})),chrome.storage.sync.get(["feature_flags"],(function(result){chrome.runtime.error||null==result.feature_flags?document.getElementById("feature_flags").checked=!0:result.feature_flags&&(document.getElementById("feature_flags").checked=!0)})),chrome.storage.sync.get(["feature_errors"],(function(result){chrome.runtime.error||null==result.feature_errors?document.getElementById("feature_errors").checked=!0:result.feature_errors&&(document.getElementById("feature_errors").checked=!0)})),chrome.storage.sync.get(["feature_dragdrop"],(function(result){chrome.runtime.error||null==result.feature_dragdrop?document.getElementById("feature_dragdrop").checked=!0:result.feature_dragdrop&&(document.getElementById("feature_dragdrop").checked=!0)})),chrome.storage.sync.get(["feature_notification"],(function(result){chrome.runtime.error||null==result.feature_notification?document.getElementById("feature_notification").checked=!0:result.feature_notification&&(document.getElementById("feature_notification").checked=!0)}));var scheme=preferesColorScheme();chrome.storage.sync.get(["feature_darkmode","feature_darkmode_auto"],(function(result){result.feature_darkmode&&!result.feature_darkmode_auto||result.feature_darkmode&&result.feature_darkmode_auto&&"dark"==scheme?(document.getElementById("feature_darkmode").checked=!0,document.querySelector("html").classList.add("dark")):result.feature_darkmode&&result.feature_darkmode_auto&&"light"==scheme?(document.getElementById("feature_darkmode").checked=!0,document.querySelector("html").classList.add("light")):(document.getElementById("feature_darkmode").checked=!1,document.getElementById("feature_darkmode_auto").disabled=!0)})),chrome.storage.sync.get(["feature_darkmode_auto"],(function(result){result.feature_darkmode_auto&&(document.getElementById("feature_darkmode_auto").checked=!0)})),chrome.storage.sync.get(["feature_favorites"],(function(result){chrome.runtime.error||null==result.feature_favorites?document.getElementById("feature_favorites").checked=!1:result.feature_favorites&&(document.getElementById("feature_favorites").checked=!0)})),chrome.storage.sync.get(["feature_reloadnode"],(function(result){chrome.runtime.error||null==result.feature_reloadnode?document.getElementById("feature_reloadnode").checked=!0:result.feature_reloadnode&&(document.getElementById("feature_reloadnode").checked=!0)})),chrome.storage.sync.get(["feature_launchpad"],(function(result){chrome.runtime.error||null==result.feature_launchpad?document.getElementById("feature_launchpad").checked=!0:result.feature_launchpad&&(document.getElementById("feature_launchpad").checked=!0)})),chrome.storage.sync.get(["feature_rtl"],(function(result){chrome.runtime.error||null==result.feature_rtl?document.getElementById("feature_rtl").checked=!0:result.feature_rtl&&(document.getElementById("feature_rtl").checked=!0)})),chrome.storage.sync.get(["feature_charscount"],(function(result){chrome.runtime.error||null==result.feature_charscount?document.getElementById("feature_charscount").checked=!0:result.feature_charscount&&(document.getElementById("feature_charscount").checked=!0)})),chrome.storage.sync.get(["feature_autoexpand"],(function(result){chrome.runtime.error||null==result.feature_autoexpand?document.getElementById("feature_autoexpand").checked=!0:result.feature_autoexpand&&(document.getElementById("feature_autoexpand").checked=!0)})),chrome.storage.sync.get(["feature_translatemode"],(function(result){chrome.runtime.error||null==result.feature_translatemode?document.getElementById("feature_translatemode").checked=!1:result.feature_translatemode&&(document.getElementById("feature_translatemode").checked=!0)})),chrome.storage.sync.get(["feature_contenteditor"],(function(result){chrome.runtime.error||null==result.feature_contenteditor?document.getElementById("feature_contenteditor").checked=!0:result.feature_contenteditor&&(document.getElementById("feature_contenteditor").checked=!0)})),chrome.storage.sync.get(["feature_experienceeditor"],(function(result){chrome.runtime.error||null==result.feature_experienceeditor?document.getElementById("feature_experienceeditor").checked=!0:result.feature_experienceeditor&&(document.getElementById("feature_experienceeditor").checked=!0)})),chrome.storage.sync.get(["feature_cetabs"],(function(result){chrome.runtime.error||null==result.feature_cetabs?document.getElementById("feature_cetabs").checked=!1:result.feature_cetabs&&(document.getElementById("feature_cetabs").checked=!0)})),chrome.storage.sync.get(["feature_rtecolor"],(function(result){chrome.runtime.error||null==result.feature_rtecolor?document.getElementById("feature_rtecolor").checked=!0:result.feature_rtecolor&&(document.getElementById("feature_rtecolor").checked=!0)})),chrome.storage.sync.get(["feature_messagebar"],(function(result){chrome.runtime.error||null==result.feature_messagebar?document.getElementById("feature_messagebar").checked=!1:result.feature_messagebar&&(document.getElementById("feature_messagebar").checked=!0)})),chrome.storage.sync.get(["feature_workbox"],(function(result){chrome.runtime.error||null==result.feature_workbox?document.getElementById("feature_workbox").checked=!0:result.feature_workbox&&(document.getElementById("feature_workbox").checked=!0)})),chrome.storage.sync.get(["feature_urlstatus"],(function(result){chrome.runtime.error||null==result.feature_urlstatus?document.getElementById("feature_urlstatus").checked=!0:result.feature_urlstatus&&(document.getElementById("feature_urlstatus").checked=!0)})),chrome.storage.sync.get(["feature_contextmenu"],(function(result){chrome.runtime.error||null==result.feature_contextmenu?document.getElementById("feature_contextmenu").checked=!0:result.feature_contextmenu&&(document.getElementById("feature_contextmenu").checked=!0)})),chrome.storage.sync.get(["feature_gravatarimage"],(function(result){chrome.runtime.error||null==result.feature_gravatarimage?document.getElementById("feature_gravatarimage").checked=!0:result.feature_gravatarimage&&(document.getElementById("feature_gravatarimage").checked=!0)})),chrome.storage.sync.get(["feature_helplink"],(function(result){chrome.runtime.error||null==result.feature_helplink?document.getElementById("feature_helplink").checked=!0:result.feature_helplink&&(document.getElementById("feature_helplink").checked=!0)})),chrome.storage.sync.get(["feature_instantsearch"],(function(result){chrome.runtime.error||null==result.feature_instantsearch?document.getElementById("feature_instantsearch").checked=!0:result.feature_instantsearch&&(document.getElementById("feature_instantsearch").checked=!0)})),chrome.storage.sync.get(["feature_experimentalui"],(function(result){chrome.runtime.error||null==result.feature_experimentalui?document.getElementById("feature_experimentalui").checked=!1:result.feature_experimentalui&&(document.getElementById("feature_experimentalui").checked=!0)}))},chrome.storage.sync.get(["feature_contrast_icons"],(function(result){null!=result.feature_contrast_icons?result.feature_contrast_icons&&(document.querySelector("#feature_contrast_icons").checked=!0):document.querySelector("#feature_contrast_icons").checked=!1})),chrome.storage.sync.get(["feature_launchpad_tiles"],(function(result){null!=result.feature_launchpad_tiles?result.feature_launchpad_tiles&&(document.querySelector("#feature_launchpad_tiles").checked=!0):document.querySelector("#feature_launchpad_tiles").checked=!1})),document.getElementById("feature_experimentalui").onclick=function(){1==document.getElementById("feature_experimentalui").checked&&(document.getElementById("feature_cetabs").checked=!0)},document.getElementById("feature_darkmode").onclick=function(){0==document.getElementById("feature_darkmode").checked?(document.getElementById("feature_darkmode_auto").disabled=!0,document.getElementById("feature_darkmode_auto").checked=!1):(document.getElementById("feature_darkmode_auto").disabled=!1,document.getElementById("feature_darkmode_auto").checked=!1)},document.querySelector("#settings").onclick=function(){document.querySelector("#main").setAttribute("style","display:none"),document.querySelector("#domains").setAttribute("style","display:block"),document.querySelector("#save").setAttribute("style","display:none")},document.querySelector("#back").onclick=function(){event.preventDefault();var url=new URL(window.location.href),configureDomains=url.searchParams.get("configure_domains"),backUrl=url.searchParams.get("url");"true"==configureDomains?(window.open(backUrl+"&sc_bw=1"),window.close()):(document.querySelector("#main").setAttribute("style","display:block"),document.querySelector("#domains").setAttribute("style","display:none"),document.querySelector("#save").setAttribute("style","display:block"))},document.querySelector("#set_domains").onclick=function(event){event.preventDefault();var domains=document.querySelectorAll("form#domains input"),count=1,domainId,currentCM,currentCD,jsonString="{",error=!1,empty=!0;for(var domain of domains){var url="";if(domain.setAttribute("style",""),domainId=parseInt(domain.name.split("[")[1].replace("]","")),currentCM=document.querySelector("input[name='cm["+domainId+"]']"),currentCD=document.querySelector("input[name='cd["+domainId+"]']"),count%2==1){if(""!=currentCM.value&&""==currentCD.value)currentCD.setAttribute("style","border-color:red"),alert("CD #"+parseInt(domainId+1)+" is missing"),error=!0;else if(""!=domain.value){empty=!1;try{url=new URL(domain.value)}catch(e){currentCM.setAttribute("style","border-color:red"),alert("CM #"+parseInt(domainId+1)+" is not a valid URL"),error=!0}}null!=url.origin&&(currentCM.value=url.origin)}else{if(""==currentCM.value&&""!=currentCD.value)alert("CM #"+parseInt(domainId+1)+" is missing"),error=!0;else if(""!=domain.value){empty=!1;try{url=new URL(domain.value)}catch(e){currentCD.setAttribute("style","border-color:red"),alert("CD #"+parseInt(domainId+1)+" is not a valid URL"),error=!0}}if(null!=url.origin){currentCD.value=url.origin;let cmUrl=new URL(currentCM.value),cdUrl=new URL(currentCD.value);"https:"==cmUrl.protocol&&"http:"==cdUrl.protocol?(alert("Warning!\nLive status might not work as expected. You will probably face a mixed-content issue as your CM and CD are using a different protocol (https vs http) \n\n"+cmUrl.origin+"\n"+cdUrl.origin),error=!0):currentCM.value==currentCD.value?(alert("CM #"+parseInt(domainId+1)+" and CD #"+parseInt(domainId+1)+" are the exact same URL, please verify."),error=!0):jsonString+='"'+currentCM.value+'":"'+currentCD.value+'",'}}count++}if("undefined"!=(jsonString=(jsonString+="}").replace(",}","}").replace("{}",void 0))){var json=JSON.parse(jsonString);console.log(json)}1==empty&&(json=""),0==error&&chrome.storage.sync.set({domain_manager:json},(function(){document.querySelector("#set_domains").innerHTML="Saving...",setTimeout((function(){document.querySelector("#set_domains").innerHTML="OK!"}),1e3),setTimeout((function(){document.querySelector("#set_domains").innerHTML="Save your domains"}),1500),console.info("--\x3e Domain manager: Saved!")}))},document.querySelector("#set").onclick=function(event){event.preventDefault(),chrome.storage.sync.set({feature_urls:document.getElementById("feature_urls").checked},(function(){console.info("--\x3e Urls: "+document.getElementById("feature_urls").checked)})),chrome.storage.sync.set({feature_flags:document.getElementById("feature_flags").checked},(function(){console.info("--\x3e Flags: "+document.getElementById("feature_flags").checked)})),chrome.storage.sync.set({feature_errors:document.getElementById("feature_errors").checked},(function(){console.info("--\x3e Errors: "+document.getElementById("feature_errors").checked)})),chrome.storage.sync.set({feature_dragdrop:document.getElementById("feature_dragdrop").checked},(function(){console.info("--\x3e Drag and drop: "+document.getElementById("feature_dragdrop").checked)})),chrome.storage.sync.set({feature_notification:document.getElementById("feature_notification").checked},(function(){console.info("--\x3e Notifications: "+document.getElementById("feature_notification").checked)})),chrome.storage.sync.set({feature_darkmode:document.getElementById("feature_darkmode").checked},(function(){console.info("--\x3e Dark mode:"+document.getElementById("feature_darkmode").checked),document.getElementById("feature_darkmode").checked?(document.querySelector("html").classList.remove("light"),document.querySelector("html").classList.add("dark")):(document.querySelector("html").classList.remove("dark"),document.querySelector("html").classList.add("light"))})),chrome.storage.sync.set({feature_darkmode_auto:document.getElementById("feature_darkmode_auto").checked},(function(){console.info("--\x3e Dark Mode Auto: "+document.getElementById("feature_darkmode_auto").checked)})),chrome.storage.sync.set({feature_favorites:document.getElementById("feature_favorites").checked},(function(){console.info("--\x3e Favorites: "+document.getElementById("feature_favorites").checked)})),chrome.storage.sync.set({feature_reloadnode:document.getElementById("feature_reloadnode").checked},(function(){console.info("--\x3e Reload: "+document.getElementById("feature_reloadnode").checked)})),chrome.storage.sync.set({feature_launchpad:document.getElementById("feature_launchpad").checked},(function(){console.info("--\x3e Launchpad: "+document.getElementById("feature_launchpad").checked)})),chrome.storage.sync.set({feature_rtl:document.getElementById("feature_rtl").checked},(function(){console.info("--\x3e RTL: "+document.getElementById("feature_rtl").checked)})),chrome.storage.sync.set({feature_charscount:document.getElementById("feature_charscount").checked},(function(){console.info("--\x3e Character counter: "+document.getElementById("feature_charscount").checked)})),chrome.storage.sync.set({feature_autoexpand:document.getElementById("feature_autoexpand").checked},(function(){console.info("--\x3e Auto Expand: "+document.getElementById("feature_autoexpand").checked)})),chrome.storage.sync.set({feature_translatemode:document.getElementById("feature_translatemode").checked},(function(){console.info("--\x3e Translation Mode: "+document.getElementById("feature_translatemode").checked)})),chrome.storage.sync.set({feature_contenteditor:document.getElementById("feature_contenteditor").checked},(function(){console.info("--\x3e Content Editor: "+document.getElementById("feature_contenteditor").checked)})),chrome.storage.sync.set({feature_experienceeditor:document.getElementById("feature_experienceeditor").checked},(function(){console.info("--\x3e Experience Editor "+document.getElementById("feature_experienceeditor").checked)})),chrome.storage.sync.set({feature_cetabs:document.getElementById("feature_cetabs").checked},(function(){console.info("--\x3e CE Tabs: "+document.getElementById("feature_cetabs").checked)})),chrome.storage.sync.set({feature_rtecolor:document.getElementById("feature_rtecolor").checked},(function(){console.info("--\x3e RTE Color: "+document.getElementById("feature_rtecolor").checked)})),chrome.storage.sync.set({feature_messagebar:document.getElementById("feature_messagebar").checked},(function(){console.info("--\x3e Fancy message bar: "+document.getElementById("feature_messagebar").checked)})),chrome.storage.sync.set({feature_workbox:document.getElementById("feature_workbox").checked},(function(){console.info("--\x3e Workflow notifications: "+document.getElementById("feature_workbox").checked)})),chrome.storage.sync.set({feature_urlstatus:document.getElementById("feature_urlstatus").checked},(function(){console.info("--\x3e Live Urls Status: "+document.getElementById("feature_urlstatus").checked)})),chrome.storage.sync.set({feature_contextmenu:document.getElementById("feature_contextmenu").checked},(function(){console.info("--\x3e Right click menu: "+document.getElementById("feature_contextmenu").checked)})),chrome.storage.sync.set({feature_gravatarimage:document.getElementById("feature_gravatarimage").checked},(function(){console.info("--\x3e Experience Profile: "+document.getElementById("feature_gravatarimage").checked)})),chrome.storage.sync.set({feature_helplink:document.getElementById("feature_helplink").checked},(function(){console.info("--\x3e Help link: "+document.getElementById("feature_helplink").checked)})),chrome.storage.sync.set({feature_instantsearch:document.getElementById("feature_instantsearch").checked},(function(){console.info("--\x3e Instant Search: "+document.getElementById("feature_instantsearch").checked)})),chrome.storage.sync.set({feature_launchpad_tiles:document.getElementById("feature_launchpad_tiles").checked},(function(){console.info("--\x3e Launchpad tiles: "+document.getElementById("feature_launchpad_tiles").checked)})),chrome.storage.sync.set({feature_experimentalui:document.getElementById("feature_experimentalui").checked},(function(){console.info("--\x3e Experimental UI: "+document.getElementById("feature_experimentalui").checked)})),chrome.storage.sync.set({feature_contrast_icons:document.getElementById("feature_contrast_icons").checked},(function(){console.info("--\x3e Contrasted icons: "+document.getElementById("feature_contrast_icons").checked)}));var url,fromLaunchpad=new URL(window.location.href).searchParams.get("launchpad");console.log("Launchpad: "+fromLaunchpad),fromLaunchpad?(document.querySelector("#set").innerHTML="Saving...",setTimeout((function(){document.querySelector("#set").innerHTML="OK!"}),1e3),setTimeout((function(){document.querySelector("#set").innerHTML="Save your preferences"}),1500)):chrome.tabs.query({active:!0,currentWindow:!0},(function(arrayOfTabs){var code="window.location.reload();";chrome.tabs.executeScript(arrayOfTabs[0].id,{code:code}),document.querySelector("#set").innerHTML="Saving...",setTimeout((function(){document.querySelector("#set").innerHTML="Save and reload sitecore"}),1e3)}))};let last_known_scroll_position=0,ticking=!1;function doSomething(scroll_pos){var element=document.getElementById("banner");scroll_pos>=90?element.classList.add("animate"):element.classList.remove("animate")}window.addEventListener("scroll",(function(){last_known_scroll_position=window.scrollY;var url,fromLaunchpad=new URL(window.location.href).searchParams.get("launchpad");ticking||fromLaunchpad||(window.requestAnimationFrame((function(){doSomething(last_known_scroll_position),ticking=!1})),ticking=!0)}));