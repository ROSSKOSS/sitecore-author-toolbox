import*as global from"./global.js";import{getSiteUrl}from"./url.js";export{showSnackbar,showSnackbarSite};const showSnackbar=storage=>{let versionIncrement=Number(global.extensionVersion.split(".").pop());if(!storage.feature_experimentalui&&0==versionIncrement){let snackbarHtml,html='<div class="snackbar">'+("\n    <b>Sitecore Author Toolbox "+global.extensionVersion+'</b><br />\n    Live URL is now compatible with multisites!<br />Click "TRY IT" to activate it now!')+'<button id="sbAction" onclick=\'javascript:document.querySelectorAll(".interfaceRadio")[1].click()\'>TRY IT</button><button id="sbDismiss">DISMISS</button></div>',parentSnackbar;!parent.document.querySelector(".snackbar")&&global.showSnackbar&&localStorage.getItem("sbDismiss")!=global.extensionVersion&&(document.querySelector("body").insertAdjacentHTML("beforeend",html),document.querySelectorAll("#sbAction, #sbDismiss").forEach((function(elem){elem.addEventListener("click",(function(){localStorage.setItem("sbDismiss",global.extensionVersion),document.querySelector(".snackbar").setAttribute("style","display: none")}))})))}},showSnackbarSite=(storage,ScItem)=>{let siteName=ScItem.pathFull.split("/home/")[0].split("/").reverse(),pathToHome=ScItem.pathFull.split("/home/")[0]+"/home/",ScSite,siteUrl=getSiteUrl(storage,pathToHome,ScItem.language).url,existing=localStorage.getItem("sbDismissSites");existing=existing?JSON.parse(existing):{};let length=Object.values(existing).length,snackbarHtml,html=`<div class="snackbarSite">${'<b>"'+siteName[0].toUpperCase()+'" site detected</b><br /> Are you using a CD server for publishing?<br />Click "Add site" to configure it now.'}<button id="sbActionSite" onclick="addSite('${global.launchpadPage}','${global.urlOrigin}','${pathToHome}', '${siteName[0].toUpperCase()}')">ADD&nbsp;SITE</button><button id="sbDismissSite">CLOSE</button></div>`;document.querySelectorAll(".snackbarSite").forEach(div=>{div.remove()}),ScItem.pathFull.includes("/home/")&&-1===Object.values(existing).indexOf(ScItem.pathFull)&&null==siteUrl&&(document.querySelector("body").insertAdjacentHTML("beforeend",html),document.querySelectorAll("#sbDismissSite").forEach((function(elem){elem.addEventListener("click",(function(){existing[length++]=ScItem.pathFull,localStorage.setItem("sbDismissSites",JSON.stringify(existing)),document.querySelector(".snackbarSite").setAttribute("style","display: none")}))})))};