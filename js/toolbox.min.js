import*as global from"./modules/global.js";import{log,loadJsFile,initDarkMode,autoDarkMode,getScItemData}from"./modules/helpers.js";import{showSnackbar}from"./modules/snackbar.js";import{workboxNotifications}from"./modules/workbox.js";import{resumeFromWhereYouLeftOff,historyNavigation}from"./modules/history.js";import{checkNotificationPermissions,checkPublishNotification}from"./modules/notification.js";import{initFlagRibbonEE,initLanguageMenuEE,initLanguageMenuCE,initFlagsPublishingWindow,initFlagsPublish}from"./modules/language.js";import{initCharsCount,initCheckboxes,initPublishCheckboxes,refreshContentEditor}from"./modules/contenteditor.js";import{initGravatarImage,initUserMenu}from"./modules/users.js";import{initInstantSearch,enhancedSitecoreSearch}from"./modules/search.js";import{insertModal,insertPanel}from"./modules/insert.js";import{initMediaExplorer,initMediaCounter,initMediaDragDrop,initMediaViewButtons}from"./modules/media.js";import{initExperimentalUi,initInsertIcon,initGutter,initColorPicker,initSitecoreMenu,initContrastedIcons,initSvgAnimation,initEventListeners}from"./modules/experimentalui.js";import{initFavorites}from"./modules/favorites.js";import{initGroupedErrors}from"./modules/errors.js";import{enhancedBucketLists}from"./modules/buckets.js";import{initRteTooltips,initSyntaxHighlighterRte}from"./modules/rte.js";import{initPreviewButton,listenPreviewTab}from"./modules/preview.js";import{initLaunchpadIcon,initLaunchpadMenu}from"./modules/launchpad.js";import{initAutoExpandTree,initTreeGutterTooltips}from"./modules/contenttree.js";import{storeCurrentPageEE,toolbarEditInCE,addToolbarTooltip,addComponentTooltip,addExtraButtons,resetExperienceEditor}from"./modules/experienceeditor.js";chrome.storage.sync.get(storage=>{if(global.isSitecore&&!global.isEditMode&&!global.isLoginPage&&!global.isCss&&!global.isUploadManager){if(log("Sitecore detected","red"),document.body.classList.add("satExtension"),loadJsFile("js/inject.js"),checkNotificationPermissions(),checkPublishNotification(storage),initUserMenu(storage),initDarkMode(storage),autoDarkMode(storage),initExperimentalUi(storage),initContrastedIcons(storage),initAutoExpandTree(storage),initTreeGutterTooltips(),refreshContentEditor(storage),global.isContentEditor){log("**** CE ****","yellow");let ScItem=getScItemData();resumeFromWhereYouLeftOff(storage),initInstantSearch(storage),initFavorites(storage),workboxNotifications(storage),historyNavigation(),showSnackbar(),storage.feature_experimentalui&&(log("**** Experimental ****","yellow"),initSvgAnimation(),insertModal(ScItem.id,ScItem.language,ScItem.version),insertPanel(),initInsertIcon(),initGutter(),initColorPicker(),initSitecoreMenu(),initEventListeners())}(global.isDesktop&&!global.isGalleryFavorites&&!global.isXmlControl||global.isLaunchpad)&&(log("**** Launchpad - Desktop Shell ****","orange"),initLaunchpadIcon(storage),initLaunchpadMenu(storage),workboxNotifications(storage)),global.isPreviewTab?(log("**** Preview tab ****","orange"),initPreviewButton(storage),listenPreviewTab(storage)):global.isMediaFolder?(log("**** Media Folder ****","orange"),initMediaCounter(),initMediaDragDrop(),initMediaViewButtons(),initMediaExplorer(storage)):global.isFieldEditor?(log("**** Field editor ****","orange"),initCheckboxes(storage),initCharsCount(storage),initGroupedErrors(storage),enhancedBucketLists()):global.isExperienceProfile?(log("**** Experience Profile ****","orange"),initGravatarImage(storage)):global.isRichTextEditor||global.isHtmlEditor?(log("**** Rich Text Editor ****","orange"),initRteTooltips(storage),initSyntaxHighlighterRte(storage)):global.isContentEditorApp&&storage.feature_experimentalui||global.isContentEditorApp&&storage.feature_instantsearch?(log("**** Content Editor App ****","orange"),document.querySelector("#globalLogo")&&document.querySelector("#globalLogo").setAttribute("target","_parent")):global.isSearch?(log("**** Internal Search ****","orange"),enhancedSitecoreSearch(storage)):global.isGalleryLanguage?(log("**** Languages menu ****","orange"),initLanguageMenuCE(storage)):global.isPublishDialog?(log("**** Publishing window ****","orange"),initFlagsPublishingWindow(storage)):global.isPublishWindow?(log("**** Publish / Rebuild / Package ****","orange"),initPublishCheckboxes(storage),initFlagsPublish(storage)):global.isUserOptions?(log("**** User options ****","orange"),document.querySelectorAll(".scTabs > div > fieldset > div").forEach((function(elem){"Quick info section"==elem.innerText&&elem.setAttribute("style","color:red; font-weight:bold"),"Item title bar"==elem.innerText&&elem.setAttribute("style","color:red; font-weight:bold")}))):global.isEditorFolder?log("**** Editors folder ****","orange"):global.isGalleryVersion?log("**** Versions menu ****","orange"):global.isLayoutDetails?log("**** Layout Details ****","orange"):global.isXmlControl&&!global.isRichText?log("**** XML Control (Window) ****","orange"):global.isDialog||global.isLockedItems?log("**** Dialog UI ****","orange"):global.isSourceBrowser?log("**** Source Browser ****","orange"):global.isGalleryLinks&&log("**** Links menu ****","orange")}(global.isEditMode&&!global.isLoginPage||global.isPreviewMode&&!global.isLoginPage)&&(log("Experience Editor detected","red"),document.body.classList.add("satExtension"),loadJsFile("js/inject.js"),checkNotificationPermissions(),initDarkMode(storage),autoDarkMode(storage),initExperimentalUi(storage),initContrastedIcons(storage),global.isRibbon?(log("**** EE Ribbon ****","orange"),initFlagRibbonEE(storage)):global.isGalleryLanguageExpEd?(log("**** Language Menu ****","orange"),initLanguageMenuEE(storage)):global.isInsertPage?log("**** Indert Page ****","orange"):(log("**** Page in EE ****","orange"),storeCurrentPageEE(),toolbarEditInCE(),addComponentTooltip(),addToolbarTooltip(),addExtraButtons(storage),resetExperienceEditor(storage)))});