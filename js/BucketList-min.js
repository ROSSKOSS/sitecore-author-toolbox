var Sitecore=Sitecore||{};Sitecore.InitBucketList=function(id,clientId,pageNumber,searchHandlerUrl,filter,databaseUrlParameter,typeToSearchString,of,enableSetStartLocation){var self={},typingTimer;self.id=id,self.clientId=clientId,self.pageNumber=pageNumber,self.searchHandlerUrl=searchHandlerUrl,self.filter=filter,self.databaseUrlParameter=databaseUrlParameter,self.typeToSearchString=typeToSearchString,self.of=of,self.enableSetStartLocation="true"===enableSetStartLocation.toLowerCase(),self.currentPage=1,self.selectedId="",self.doneTypingInterval=2e3,self.contentLanguage=$("scLanguage")&&$("scLanguage").value,self.format=function(e){var t=arguments;return e.replace(/\{(\d+)\}/g,(function(e,l){return t[parseInt(l)+1]}))},self.sendRequest=function(e,t,l){console.log(t),new Ajax.Request(e,{method:"POST",parameters:t,onSuccess:new self.SuccessHandler(l)})},self.SuccessHandler=function(multilist){return function(request){var response=eval(request.responseText);multilist.options.length=0,multilist.removeClassName("loadingItems");var itemIdsHash={},reducedItems=[],i,item,author,folder;for(i=0;i<response.items.length;i++)item=response.items[i],itemIdsHash[item.ItemId]||(itemIdsHash[item.ItemId]=!0,reducedItems[reducedItems.length]=item);for(i=0;i<reducedItems.length;i++)item=reducedItems[i],author=item.CreatedBy,author=author.split("\\"),folder=item.Path,folder=folder.split("/Home/"),multilist.options[multilist.options.length]=new Option("ðŸ‘¤"+author[1]+" --\x3e "+folder[1],item.ItemId);self.pageNumber=response.PageNumbers,self.currentPage=response.CurrentPage,$("pageNumber"+self.clientId).innerHTML=self.format(self.of,self.currentPage,self.pageNumber)}},self.getSelectedItemId=function(e){for(var t=scForm.browser.getControl(self.id+e),l=0;l<t.options.length;l++){var r=t.options[l];if(r.selected)return r.value}return null},self.onFilterFocus=function(e){e.value==self.typeToSearchString&&(e.value=""),e.addClassName("active").removeClassName("inactive")},self.onFilterBlur=function(e){e.value||(e.value=self.typeToSearchString),e.removeClassName("active").addClassName("inactive")},self.moveToCurrentPage=function(){var e=document.getElementById("filterBox"+self.clientId),t=e.value&&e.value!=self.typeToSearchString?e.value:"*",l=$(self.clientId+"_unselected").addClassName("loadingItems"),r=encodeURIComponent(t),s=self.enableSetStartLocation?self.getOverrideString("%2Blocation="):self.filter,n=self.getSelectedIdsFilter();self.sendRequest(self.searchHandlerUrl,"fromBucketListField="+r+"&"+s.replace(/\+/g,"%2B")+n+"&pageNumber="+self.currentPage+self.databaseUrlParameter+"&scLanguage="+self.contentLanguage,l)},self.getOverrideString=function(e){var t=document.getElementById("locationOverride"+self.clientId);if(!t||!t.value.length>0)return self.filter;var l=self.filter.indexOf(e);if(!~l)return self.filter;var r=self.filter.indexOf("&",l+1);~r||(r=self.filter.length);var s=self.filter.substring(l,r);return self.filter.replace(s,e+t.value)},self.getSelectedIdsFilter=function(){return[].slice.call($(self.clientId+"_selected").options,0).map((function(e){return"&-id="+e.value})).join("")},self.initEventHandlers=function(){$("filterBox"+self.clientId).observe("focus",(function(){self.onFilterFocus($("filterBox"+self.clientId))})),$("filterBox"+self.clientId).observe("blur",(function(){self.onFilterBlur($("filterBox"+self.clientId))})),$("filterBox"+self.clientId).observe("keyup",(function(){typingTimer=setTimeout((function(){self.currentPage=1,self.moveToCurrentPage()}),self.doneTypingInterval)})),$("filterBox"+self.clientId).observe("keydown",(function(){clearTimeout(typingTimer)})),$("next"+self.clientId).observe("click",(function(){self.currentPage+1<=self.pageNumber&&(self.currentPage++,self.moveToCurrentPage())})),$("prev"+self.clientId).observe("click",(function(){self.currentPage>1&&(self.currentPage--,self.moveToCurrentPage())})),$(self.id+"_unselected").observe("dblclick",(function(){scContent.multilistMoveRight(self.id)})),$(self.id+"_selected").observe("dblclick",(function(){scContent.multilistMoveLeft(self.id)})),$(self.id+"_unselected").observe("click",(function(){self.selectedId=self.getSelectedItemId("_unselected")})),$(self.id+"_selected").observe("click",(function(){self.selectedId=self.getSelectedItemId("_selected")})),$("btnRight"+self.id).observe("click",(function(){scContent.multilistMoveRight(self.id)})),$("btnLeft"+self.id).observe("click",(function(){scContent.multilistMoveLeft(self.id)})),$("refresh"+self.clientId).observe("click",(function(){self.currentPage=1,self.moveToCurrentPage()})),$("goto"+self.clientId).observe("click",(function(){return scForm.postRequest("","","","contenteditor:launchtab(url="+self.selectedId+", la="+self.contentLanguage+")"),!1}))};var pageNumberElement=$("pageNumber"+self.clientId);pageNumberElement&&(pageNumberElement.innerHTML=self.format(self.of,self.currentPage,self.pageNumber),self.initEventHandlers(),self.moveToCurrentPage())};